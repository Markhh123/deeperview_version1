{
  "name": "SemanticModel",
  "compatibilityLevel": 1200,
  "model": {
    "culture": "en-GB",
    "dataSources": [
      {
        "name": "Custom 25",
        "connectionString": "Provider=MSDASQL.1;Persist Security Info=False;User ID=ssas;Extended Properties=\"DSN=PostgreSQL30;Database=prod\";Initial Catalog=prod",
        "impersonationMode": "impersonateCurrentUser",
        "annotations": [
          {
            "name": "ConnectionEditUISource",
            "value": "Others"
          }
        ]
      }
    ],
    "tables": [
      {
        "name": "AdUnit",
        "columns": [
          {
            "name": "greatgreatgrandparentname",
            "dataType": "string",
            "sourceColumn": "greatgreatgrandparentname"
          },
          {
            "name": "false level",
            "dataType": "string",
            "sourceColumn": "false level"
          },
          {
            "name": "greatgrandparentname",
            "dataType": "string",
            "sourceColumn": "greatgrandparentname"
          },
          {
            "name": "grandparentname",
            "dataType": "string",
            "sourceColumn": "grandparentname"
          },
          {
            "name": "parentname",
            "dataType": "string",
            "sourceColumn": "parentname"
          },
          {
            "name": "childname",
            "dataType": "string",
            "sourceColumn": "childname"
          },
          {
            "name": "ad_unit_id",
            "dataType": "string",
            "sourceColumn": "ad_unit_id"
          }
        ],
        "partitions": [
          {
            "name": "Query",
            "source": {
              "query": [
                "SELECT greatgreatgrandparentname, \"false level\", greatgrandparentname, grandparentname, parentname, childname, ad_unit_id ",
                " FROM ftdeepviewdb.ad_unit_new_final"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "TableWidgetSerialization"
              },
              {
                "name": "TableWidgetSourceTable"
              },
              {
                "name": "QueryEditorSerialization"
              }
            ]
          }
        ],
        "hierarchies": [
          {
            "name": "Ad Units",
            "levels": [
              {
                "name": "Site",
                "ordinal": 0,
                "column": "false level"
              },
              {
                "name": "Primary Ad Unit",
                "ordinal": 1,
                "column": "greatgrandparentname"
              },
              {
                "name": "Secondary Ad Unit",
                "ordinal": 2,
                "column": "grandparentname"
              },
              {
                "name": "Tertiary Ad Unit",
                "ordinal": 3,
                "column": "parentname"
              },
              {
                "name": "Ad Unit",
                "ordinal": 4,
                "column": "childname"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Query"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "SELECT greatgreatgrandparentname, \"false level\", greatgrandparentname, grandparentname, parentname, childname, ad_unit_id ",
              " FROM ftdeepviewdb.ad_unit_new_final"
            ]
          }
        ]
      },
      {
        "name": "Advertisers",
        "columns": [
          {
            "name": "advertiser_key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "advertiser_key"
          },
          {
            "name": "advertiser name unpaid",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "advertiser name unpaid"
          },
          {
            "name": "campaign name unpaid",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "campaign name unpaid"
          },
          {
            "name": "line item name unpaid",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "line item name unpaid"
          },
          {
            "name": "advertiser name paid",
            "dataType": "string",
            "sourceColumn": "advertiser name paid"
          },
          {
            "name": "campaign name paid",
            "dataType": "string",
            "sourceColumn": "campaign name paid"
          },
          {
            "name": "line item name paid",
            "dataType": "string",
            "sourceColumn": "line item name paid"
          },
          {
            "name": "buy_type",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "buy_type"
          },
          {
            "name": "cost_model",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "cost_model"
          },
          {
            "name": "currency_code",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "currency_code"
          },
          {
            "name": "exchange_rate",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "exchange_rate"
          },
          {
            "name": "agency_commission",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "agency_commission"
          },
          {
            "name": "gross_rate_local",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "gross_rate_local"
          },
          {
            "name": "gross_value_local",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "gross_value_local"
          },
          {
            "name": "gross_rate_gbp",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "gross_rate_gbp"
          },
          {
            "name": "gross_value_gbp",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "gross_value_gbp"
          },
          {
            "name": "net_rate_gbp",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "net_rate_gbp"
          },
          {
            "name": "net_value_gbp",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "net_value_gbp"
          },
          {
            "name": "startdate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "startdate"
          },
          {
            "name": "enddate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "enddate"
          },
          {
            "type": "calculated",
            "name": "duration",
            "dataType": "double",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "1. *([enddate]-[startdate])"
          },
          {
            "type": "calculated",
            "name": "netrate",
            "dataType": "double",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": [
              "if(or(or(or(or(Advertisers[roadblock_type] = \"Roadblock Master\",Advertisers[roadblock_type] = \"Wrap Master\"), Advertisers[cost_model] = \"CPD\"),Advertisers[wrap_type]=\"Wrap\"),Advertisers[product_name]=\"SmartMatch (AA243)\"),    0,",
              "",
              "if(Advertisers[net_rate_gbp]/Advertisers[net_value_gbp] < 0.98,",
              "\t\t\t\t\tif(Advertisers[measured_by_time]= \"No\",[net_rate_gbp]/1000000000,0)",
              "\t\t\t,0))"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\" xmlns=\"\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "netvalue",
            "dataType": "double",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "if(Advertisers[net_rate_gbp]<> Advertisers[net_value_gbp],[net_value_gbp]/100000000000,0)",
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\" xmlns=\"\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "netvalueduration",
            "dataType": "double",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "if(or(Advertisers[net_rate_gbp]= Advertisers[net_value_gbp],Advertisers[product_name] = \"SmartMatch (AA243)\"),[net_value_gbp]/1000000/[duration],0)",
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\" xmlns=\"\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "live",
            "dataType": "int64",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "if([enddate]<=NOW(),1,0)"
          },
          {
            "type": "calculated",
            "name": "startdatekey",
            "dataType": "double",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "value(mid([startdate],7,4) & mid([startdate],4,2)  & mid([startdate],1,2))"
          },
          {
            "name": "measured_by_time",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "measured_by_time"
          },
          {
            "type": "calculated",
            "name": "Cost_Model2",
            "dataType": "string",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": [
              "if(and([measured_by_time] = \"Yes\",[net_rate_gbp] >0),\"CPH\", ",
              "\t\t\t\t\tif([cost_model] = \"CPD\",\"CPD\",",
              "\t\t\t\t\t\t\tif([product_name] = \"SmartMatch (AA243)\",\"Smart Match\",",
              "\t\t\t\t\t\t\t\t\tif(or([net_rate_gbp]/[net_value_gbp] < 0.98,[net_rate_gbp]/[net_value_gbp] > 1.1) &&  [measured_by_time]= \"No\"\t,\"CPM\",  ",
              "\t\t\t\t\t\t\t\t\t\t\tif(or([net_rate_gbp]/[net_value_gbp] > 0.98,[net_rate_gbp]/[net_value_gbp] < 1.1) &&  [measured_by_time]= \"No\" && [product_name] <> \"SmartMatch (AA243)\",\"SPR\",",
              "\t\t\t\t\t\t\t\t\t\t\t     \t",
              "\"Unknown\")))))"
            ]
          },
          {
            "name": "adcreative_key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "adcreative_key"
          },
          {
            "name": "line_item_name",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "line_item_name"
          },
          {
            "name": "creative_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "creative_key"
          },
          {
            "name": "creative_name",
            "dataType": "string",
            "sourceColumn": "creative_name"
          },
          {
            "name": "roadblock_type",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "roadblock_type"
          },
          {
            "name": "creative_id_name",
            "dataType": "string",
            "sourceColumn": "creative_id_name"
          },
          {
            "name": "wrap_type",
            "dataType": "string",
            "sourceColumn": "wrap_type"
          },
          {
            "name": "product_name",
            "dataType": "string",
            "sourceColumn": "product_name"
          }
        ],
        "partitions": [
          {
            "name": "dim_advertiser",
            "source": {
              "query": [
                "with cte as (SELECT *",
                "",
                "FROM ftdeepviewdb.dim_advertiser",
                "where advertiser_key not in (select advertiser_key from ftdeepviewdb.dim_advertiser_unpaid)",
                ")",
                "SELECT ",
                "isnull(creative_key || da.advertiser_key, cast(da.advertiser_key as varchar))  as adcreative_key,",
                "da.advertiser_key,",
                "isnull(du.advertiser_name, 'Xcluded - Paid') as \"Advertiser Name Unpaid\",",
                "isnull(du.campaign_name, 'Xcluded - Paid') as \"Campaign Name Unpaid\",",
                "isnull(du.line_item_name, 'Xcluded - Paid') as \"Line Item Name Unpaid\",",
                "isnull(c.advertiser_name, 'Xcluded - Unpaid') as \"Advertiser Name paid\",",
                "isnull(c.campaign_name, 'Xcluded - Unpaid') as \"Campaign Name paid\",",
                "isnull(c.line_item_name, 'Xcluded - Unpaid') as \"Line Item Name paid\",",
                "da.line_item_name,",
                "isnull(da.buy_type, 'UNKNOWN') as buy_type ,",
                "isnull(da.cost_model, 'UNKNOWN') as cost_model,",
                "da.currency_code, ",
                "da.exchange_rate,",
                "dcr.creative_key,",
                "dcr.creative_name, ",
                "da.agency_commission, ",
                "da.gross_rate_local, ",
                "da.gross_value_local, ",
                "da.gross_rate_gbp, ",
                "da.gross_value_gbp, ",
                "da.net_rate_gbp, ",
                "da.net_value_gbp, ",
                "da.startdate, ",
                "da.enddate ,",
                "da.measured_by_time,",
                "case",
                "when c.roadblock_type = 'unknown' then isnull(da.wrap_type,'unknown')",
                "when da.roadblock_type = 'Wrap Master' then 'Wrap'",
                "when da.roadblock_type = 'Wrap Companion' then 'Wrap'",
                "when da.roadblock_type = 'Standard non M/C' then 'Standard / non wrap'",
                "when da.roadblock_type = 'Roadblock Companion' then 'Wrap'",
                "when da.roadblock_type = 'Roadblock Master' then 'Wrap'",
                "when da.wrap_type is null then isnull(da.roadblock_type, 'unknown')",
                "else da.wrap_type",
                "end as  roadblock_type,",
                "dcr.creative_id || ' - ' || dcr.creative_id_name as creative_id_name,da.wrap_type ,da.product_name",
                "FROM ftdeepviewdb.dim_advertiser da ",
                "left join ftdeepviewdb.dim_advertiser_unpaid du on du.advertiser_key = da.advertiser_key",
                "left join cte c on c.advertiser_key = da.advertiser_key",
                "left join ftdeepviewdb.dim_creative dcr on dcr.line_item_id  = da.line_item_id",
                "union",
                "select '-2', null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>with cte as (SELECT *",
                  "",
                  "FROM ftdeepviewdb.dim_advertiser",
                  "where advertiser_key not in (select advertiser_key from ftdeepviewdb.dim_advertiser_unpaid)",
                  ")",
                  "SELECT ",
                  "isnull(creative_key || da.advertiser_key, cast(da.advertiser_key as varchar))  as adcreative_key,",
                  "da.advertiser_key,",
                  "isnull(du.advertiser_name, 'Xcluded - Paid') as \"Advertiser Name Unpaid\",",
                  "isnull(du.campaign_name, 'Xcluded - Paid') as \"Campaign Name Unpaid\",",
                  "isnull(du.line_item_name, 'Xcluded - Paid') as \"Line Item Name Unpaid\",",
                  "isnull(c.advertiser_name, 'Xcluded - Unpaid') as \"Advertiser Name paid\",",
                  "isnull(c.campaign_name, 'Xcluded - Unpaid') as \"Campaign Name paid\",",
                  "isnull(c.line_item_name, 'Xcluded - Unpaid') as \"Line Item Name paid\",",
                  "da.line_item_name,",
                  "isnull(da.buy_type, 'UNKNOWN') as buy_type ,",
                  "isnull(da.cost_model, 'UNKNOWN') as cost_model,",
                  "da.currency_code, ",
                  "da.exchange_rate,",
                  "dcr.creative_key,",
                  "dcr.creative_name, ",
                  "da.agency_commission, ",
                  "da.gross_rate_local, ",
                  "da.gross_value_local, ",
                  "da.gross_rate_gbp, ",
                  "da.gross_value_gbp, ",
                  "da.net_rate_gbp, ",
                  "da.net_value_gbp, ",
                  "da.startdate, ",
                  "da.enddate ,",
                  "da.measured_by_time,",
                  "case",
                  "when c.roadblock_type = 'unknown' then isnull(da.wrap_type,'unknown')",
                  "when da.roadblock_type = 'Wrap Master' then 'Wrap'",
                  "when da.roadblock_type = 'Wrap Companion' then 'Wrap'",
                  "when da.roadblock_type = 'Standard non M/C' then 'Standard / non wrap'",
                  "when da.roadblock_type = 'Roadblock Companion' then 'Wrap'",
                  "when da.roadblock_type = 'Roadblock Master' then 'Wrap'",
                  "when da.wrap_type is null then isnull(da.roadblock_type, 'unknown')",
                  "else da.wrap_type",
                  "end as  roadblock_type,",
                  "dcr.creative_id || ' - ' || dcr.creative_id_name as creative_id_name,da.wrap_type ,da.product_name",
                  "FROM ftdeepviewdb.dim_advertiser da ",
                  "left join ftdeepviewdb.dim_advertiser_unpaid du on du.advertiser_key = da.advertiser_key",
                  "left join cte c on c.advertiser_key = da.advertiser_key",
                  "left join ftdeepviewdb.dim_creative dcr on dcr.line_item_id  = da.line_item_id",
                  "union",
                  "select '-2', null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "hierarchies": [
          {
            "name": "Advertisers Unpaid",
            "levels": [
              {
                "name": "advertiser name unpaid",
                "ordinal": 0,
                "column": "advertiser name unpaid"
              },
              {
                "name": "campaign name unpaid",
                "ordinal": 1,
                "column": "campaign name unpaid"
              },
              {
                "name": "line item name unpaid",
                "ordinal": 2,
                "column": "line item name unpaid"
              }
            ]
          },
          {
            "name": "Advertisers Paid",
            "levels": [
              {
                "name": "advertiser name paid",
                "ordinal": 0,
                "column": "advertiser name paid"
              },
              {
                "name": "campaign name paid",
                "ordinal": 1,
                "column": "campaign name paid"
              },
              {
                "name": "line item name paid",
                "ordinal": 2,
                "column": "line item name paid"
              },
              {
                "name": "creative_name",
                "ordinal": 3,
                "column": "creative_name"
              },
              {
                "name": "creative_id_name",
                "ordinal": 4,
                "column": "creative_id_name"
              }
            ]
          },
          {
            "name": "Cost Model",
            "levels": [
              {
                "name": "CostModel",
                "ordinal": 0,
                "column": "Cost_Model2"
              }
            ]
          },
          {
            "name": "Wraps",
            "levels": [
              {
                "name": "roadblock_type",
                "ordinal": 0,
                "column": "roadblock_type"
              }
            ]
          },
          {
            "name": "Product Name",
            "levels": [
              {
                "name": "product_name",
                "ordinal": 0,
                "column": "product_name"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbSchemaName",
            "value": "ftdeepviewdb"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_advertiser"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "with cte as (SELECT *",
              "",
              "FROM ftdeepviewdb.dim_advertiser",
              "where advertiser_key not in (select advertiser_key from ftdeepviewdb.dim_advertiser_unpaid)",
              ")",
              "SELECT ",
              "isnull(creative_key || da.advertiser_key, cast(da.advertiser_key as varchar))  as adcreative_key,",
              "da.advertiser_key,",
              "isnull(du.advertiser_name, 'Xcluded - Paid') as \"Advertiser Name Unpaid\",",
              "isnull(du.campaign_name, 'Xcluded - Paid') as \"Campaign Name Unpaid\",",
              "isnull(du.line_item_name, 'Xcluded - Paid') as \"Line Item Name Unpaid\",",
              "isnull(c.advertiser_name, 'Xcluded - Unpaid') as \"Advertiser Name paid\",",
              "isnull(c.campaign_name, 'Xcluded - Unpaid') as \"Campaign Name paid\",",
              "isnull(c.line_item_name, 'Xcluded - Unpaid') as \"Line Item Name paid\",",
              "da.line_item_name,",
              "isnull(da.buy_type, 'UNKNOWN') as buy_type ,",
              "isnull(da.cost_model, 'UNKNOWN') as cost_model,",
              "da.currency_code, ",
              "da.exchange_rate,",
              "dcr.creative_key,",
              "dcr.creative_name, ",
              "da.agency_commission, ",
              "da.gross_rate_local, ",
              "da.gross_value_local, ",
              "da.gross_rate_gbp, ",
              "da.gross_value_gbp, ",
              "da.net_rate_gbp, ",
              "da.net_value_gbp, ",
              "da.startdate, ",
              "da.enddate ,",
              "da.measured_by_time,",
              "case",
              "when c.roadblock_type = 'unknown' then isnull(da.wrap_type,'unknown')",
              "when da.roadblock_type = 'Wrap Master' then 'Wrap'",
              "when da.roadblock_type = 'Wrap Companion' then 'Wrap'",
              "when da.roadblock_type = 'Standard non M/C' then 'Standard / non wrap'",
              "when da.roadblock_type = 'Roadblock Companion' then 'Wrap'",
              "when da.roadblock_type = 'Roadblock Master' then 'Wrap'",
              "when da.wrap_type is null then isnull(da.roadblock_type, 'unknown')",
              "else da.wrap_type",
              "end as  roadblock_type,",
              "dcr.creative_id || ' - ' || dcr.creative_id_name as creative_id_name,da.wrap_type ,da.product_name",
              "FROM ftdeepviewdb.dim_advertiser da ",
              "left join ftdeepviewdb.dim_advertiser_unpaid du on du.advertiser_key = da.advertiser_key",
              "left join cte c on c.advertiser_key = da.advertiser_key",
              "left join ftdeepviewdb.dim_creative dcr on dcr.line_item_id  = da.line_item_id",
              "union",
              "select '-2', null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null"
            ]
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>with cte as (SELECT *",
              "",
              "FROM ftdeepviewdb.dim_advertiser",
              "where advertiser_key not in (select advertiser_key from ftdeepviewdb.dim_advertiser_unpaid)",
              ")",
              "SELECT ",
              "isnull(creative_key || da.advertiser_key, cast(da.advertiser_key as varchar))  as adcreative_key,",
              "da.advertiser_key,",
              "isnull(du.advertiser_name, 'Xcluded - Paid') as \"Advertiser Name Unpaid\",",
              "isnull(du.campaign_name, 'Xcluded - Paid') as \"Campaign Name Unpaid\",",
              "isnull(du.line_item_name, 'Xcluded - Paid') as \"Line Item Name Unpaid\",",
              "isnull(c.advertiser_name, 'Xcluded - Unpaid') as \"Advertiser Name paid\",",
              "isnull(c.campaign_name, 'Xcluded - Unpaid') as \"Campaign Name paid\",",
              "isnull(c.line_item_name, 'Xcluded - Unpaid') as \"Line Item Name paid\",",
              "da.line_item_name,",
              "isnull(da.buy_type, 'UNKNOWN') as buy_type ,",
              "isnull(da.cost_model, 'UNKNOWN') as cost_model,",
              "da.currency_code, ",
              "da.exchange_rate,",
              "dcr.creative_key,",
              "dcr.creative_name, ",
              "da.agency_commission, ",
              "da.gross_rate_local, ",
              "da.gross_value_local, ",
              "da.gross_rate_gbp, ",
              "da.gross_value_gbp, ",
              "da.net_rate_gbp, ",
              "da.net_value_gbp, ",
              "da.startdate, ",
              "da.enddate ,",
              "da.measured_by_time,",
              "case",
              "when c.roadblock_type = 'unknown' then isnull(da.wrap_type,'unknown')",
              "when da.roadblock_type = 'Wrap Master' then 'Wrap'",
              "when da.roadblock_type = 'Wrap Companion' then 'Wrap'",
              "when da.roadblock_type = 'Standard non M/C' then 'Standard / non wrap'",
              "when da.roadblock_type = 'Roadblock Companion' then 'Wrap'",
              "when da.roadblock_type = 'Roadblock Master' then 'Wrap'",
              "when da.wrap_type is null then isnull(da.roadblock_type, 'unknown')",
              "else da.wrap_type",
              "end as  roadblock_type,",
              "dcr.creative_id || ' - ' || dcr.creative_id_name as creative_id_name,da.wrap_type ,da.product_name",
              "FROM ftdeepviewdb.dim_advertiser da ",
              "left join ftdeepviewdb.dim_advertiser_unpaid du on du.advertiser_key = da.advertiser_key",
              "left join cte c on c.advertiser_key = da.advertiser_key",
              "left join ftdeepviewdb.dim_creative dcr on dcr.line_item_id  = da.line_item_id",
              "union",
              "select '-2', null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null, null,null,null,null</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "Categories",
        "columns": [
          {
            "name": "category_key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "category_key"
          },
          {
            "name": "category_code",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "category_code"
          },
          {
            "name": "parent_category",
            "dataType": "string",
            "sourceColumn": "parent_category"
          },
          {
            "name": "sub_category",
            "dataType": "string",
            "sourceColumn": "sub_category"
          }
        ],
        "partitions": [
          {
            "name": "dim_category",
            "source": {
              "query": "SELECT [ftdeepviewdb].[dim_category].*   FROM [ftdeepviewdb].[dim_category]",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization"
              },
              {
                "name": "TableWidgetSerialization"
              }
            ]
          }
        ],
        "hierarchies": [
          {
            "name": "Ad Categories",
            "levels": [
              {
                "name": "parent_category",
                "ordinal": 0,
                "column": "parent_category"
              },
              {
                "name": "sub_category",
                "ordinal": 1,
                "column": "sub_category"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbSchemaName",
            "value": "ftdeepviewdb"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_category"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "     SELECT [ftdeepviewdb].[dim_category].*   FROM [ftdeepviewdb].[dim_category] "
          }
        ]
      },
      {
        "name": "Region",
        "columns": [
          {
            "name": "country",
            "dataType": "string",
            "sourceColumn": "country"
          },
          {
            "name": "region",
            "dataType": "string",
            "sourceColumn": "region"
          },
          {
            "name": "city",
            "dataType": "string",
            "sourceColumn": "city"
          },
          {
            "name": "dim_event_country_key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dim_event_country_key"
          },
          {
            "name": "continent",
            "dataType": "string",
            "sourceColumn": "continent"
          },
          {
            "name": "trade_region",
            "dataType": "string",
            "sourceColumn": "trade_region"
          }
        ],
        "partitions": [
          {
            "name": "dim_event_country",
            "source": {
              "query": "SELECT [ftdeepviewdb].[dim_event_country].[country],[ftdeepviewdb].[dim_event_country].[region],[ftdeepviewdb].[dim_event_country].[city],[ftdeepviewdb].[dim_event_country].[dim_event_country_key],[ftdeepviewdb].[dim_event_country].[continent] ,trade_region  FROM [ftdeepviewdb].[dim_event_country]",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "TableWidgetSerialization"
              },
              {
                "name": "TableWidgetSourceTable"
              },
              {
                "name": "QueryEditorSerialization"
              }
            ]
          }
        ],
        "hierarchies": [
          {
            "name": "Regions",
            "levels": [
              {
                "name": "continent",
                "ordinal": 0,
                "column": "continent"
              },
              {
                "name": "country",
                "ordinal": 1,
                "column": "country"
              },
              {
                "name": "region",
                "ordinal": 2,
                "column": "region"
              },
              {
                "name": "city",
                "ordinal": 3,
                "column": "city"
              }
            ]
          },
          {
            "name": "Trade Areas",
            "levels": [
              {
                "name": "trade_region",
                "ordinal": 0,
                "column": "trade_region"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbSchemaName",
            "value": "ftdeepviewdb"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_event_country"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "SELECT [ftdeepviewdb].[dim_event_country].[country],[ftdeepviewdb].[dim_event_country].[region],[ftdeepviewdb].[dim_event_country].[city],[ftdeepviewdb].[dim_event_country].[dim_event_country_key],[ftdeepviewdb].[dim_event_country].[continent] ,trade_region  FROM [ftdeepviewdb].[dim_event_country]"
          }
        ]
      },
      {
        "name": "Event_Demographics",
        "columns": [
          {
            "name": "dim_event_demographics_key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dim_event_demographics_key"
          },
          {
            "name": "os",
            "dataType": "string",
            "sourceColumn": "os"
          },
          {
            "name": "internetconnection",
            "dataType": "string",
            "sourceColumn": "internetconnection"
          },
          {
            "name": "browser",
            "dataType": "string",
            "sourceColumn": "browser"
          },
          {
            "name": "ad_position",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ad_position"
          },
          {
            "name": "creative_size",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "creative_size"
          }
        ],
        "partitions": [
          {
            "name": "dim_event_demographics",
            "source": {
              "query": "SELECT [ftdeepviewdb].[dim_event_demographics].*   FROM [ftdeepviewdb].[dim_event_demographics]",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization"
              },
              {
                "name": "TableWidgetSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbSchemaName",
            "value": "ftdeepviewdb"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_event_demographics"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "     SELECT [ftdeepviewdb].[dim_event_demographics].*   FROM [ftdeepviewdb].[dim_event_demographics] "
          }
        ]
      },
      {
        "name": "Time_of_Day",
        "columns": [
          {
            "name": "dim_time_key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dim_time_key"
          },
          {
            "name": "hour",
            "dataType": "string",
            "sourceColumn": "hour"
          },
          {
            "name": "daycategory",
            "dataType": "string",
            "sourceColumn": "daycategory"
          }
        ],
        "partitions": [
          {
            "name": "dim_time",
            "source": {
              "query": "SELECT [ftdeepviewdb].[dim_time].*   FROM [ftdeepviewdb].[dim_time]",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization"
              },
              {
                "name": "TableWidgetSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbSchemaName",
            "value": "ftdeepviewdb"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_time"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "     SELECT [ftdeepviewdb].[dim_time].*   FROM [ftdeepviewdb].[dim_time] "
          }
        ]
      },
      {
        "name": "Metrics",
        "columns": [
          {
            "name": "date_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "date_key"
          },
          {
            "name": "imp_demos_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "imp_demos_key"
          },
          {
            "name": "user_demos_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "user_demos_key"
          },
          {
            "name": "category_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "category_key"
          },
          {
            "name": "advertiser_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "advertiser_key"
          },
          {
            "name": "ad_unit_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "ad_unit_key"
          },
          {
            "name": "country_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "country_key"
          },
          {
            "name": "dfp_impression_erights_id",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dfp_impression_erights_id"
          },
          {
            "name": "dfp_impression_user_id",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dfp_impression_user_id"
          },
          {
            "name": "dfp_click_erights_id",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dfp_click_erights_id"
          },
          {
            "name": "dfp_click_user_id",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dfp_click_user_id"
          },
          {
            "name": "time_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "time_key"
          },
          {
            "name": "value",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "value"
          },
          {
            "name": "event_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "event_key"
          },
          {
            "type": "calculated",
            "name": "Impressions",
            "dataType": "int64",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "IF('Metrics'[event_key] =1,1,0)"
          },
          {
            "type": "calculated",
            "name": "Clicks",
            "dataType": "int64",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "IF('Metrics'[event_key] =0,1,0)"
          },
          {
            "type": "calculated",
            "name": "netcpm",
            "dataType": "int64",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": [
              "if([event_key] = 1,if(related(Advertisers[buy_type]) = \"Traffic Driver\",1,",
              "\t\t\tif(or(related(Advertisers[buy_type]) = \"Added Value\",related(Advertisers[buy_type]) = \"Monetised Inventory\"),1,if(related(Advertisers[buy_type]) = \"FT Adviser\",1,0))),0)",
              ""
            ]
          },
          {
            "type": "calculated",
            "name": "costperunit",
            "dataType": "double",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "related(Advertisers[netrate])"
          },
          {
            "type": "calculated",
            "name": "revenuecalc",
            "dataType": "double",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "If([tablekey] = RELATED(DailyCounts[tablekey]),related(DailyCounts[dailyrevenue]))"
          },
          {
            "name": "creative_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "creative_key"
          },
          {
            "name": "ad_position",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ad_position"
          },
          {
            "name": "creative_size",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "creative_size"
          },
          {
            "name": "adcreative_key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "adcreative_key"
          },
          {
            "name": "tablekey",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "tablekey"
          },
          {
            "name": "pt",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "pt"
          },
          {
            "name": "res",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "res"
          },
          {
            "name": "slv",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "slv"
          },
          {
            "name": "industry",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "industry"
          },
          {
            "name": "position",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "position"
          },
          {
            "name": "responsibility",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "responsibility"
          },
          {
            "name": "segmentid",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "segmentid"
          },
          {
            "name": "gender",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "gender"
          },
          {
            "name": "guid",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "guid"
          },
          {
            "name": "admant",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "admant"
          },
          {
            "name": "category",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "category"
          },
          {
            "name": "user_id",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "user_id"
          },
          {
            "name": "krux_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "krux_key"
          },
          {
            "name": "auuid",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "auuid"
          },
          {
            "name": "activeview_eligibleimpression",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "activeview_eligibleimpression"
          },
          {
            "name": "measurable_impression",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "measurable_impression"
          },
          {
            "name": "viewable_impression",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "viewable_impression"
          },
          {
            "type": "calculated",
            "name": "clicks_users",
            "dataType": "int64",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "if(isblank([dfp_click_erights_id]),if(or([guid]= \"UNKN\",isblank([guid])),0,1),1)"
          },
          {
            "type": "calculated",
            "name": "impressions_users",
            "dataType": "int64",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "if(isblank([dfp_impression_erights_id]),if(or([guid]= \"UNKN\",isblank([guid])),0,1),1)"
          },
          {
            "name": "totalinviewtime_average",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "totalinviewtime_average"
          },
          {
            "name": "totalinview_time",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "totalinview_time"
          },
          {
            "name": "activeinviewtime_average",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "activeinviewtime_average"
          },
          {
            "name": "activepagedwell_content",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "activepagedwell_content"
          },
          {
            "name": "timeuntilinview",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "timeuntilinview"
          },
          {
            "name": "totalinviewimpressions",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "totalinviewimpressions"
          },
          {
            "name": "totalmeasurableimpressions",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "totalmeasurableimpressions"
          },
          {
            "name": "totalimpressionsunfiltered",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "totalimpressionsunfiltered"
          },
          {
            "name": "nhtmeasurableimpressions",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "nhtmeasurableimpressions"
          },
          {
            "name": "nht_totalimpressions",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "nht_totalimpressions"
          },
          {
            "name": "totalinteractions",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "totalinteractions"
          },
          {
            "name": "inview_false",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "inview_false"
          },
          {
            "name": "activeinviewtime",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "activeinviewtime"
          },
          {
            "name": "automated_browser_rate",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "automated_browser_rate"
          },
          {
            "name": "incongruous_browser_rate",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "incongruous_browser_rate"
          },
          {
            "name": "data_center_traffic_rate",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "data_center_traffic_rate"
          },
          {
            "name": "isknownspider_rate",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "isknownspider_rate"
          },
          {
            "name": "scroll",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "scroll"
          },
          {
            "name": "scroll_count",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "scroll_count"
          },
          {
            "name": "belowfoldad",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "belowfoldad"
          },
          {
            "name": "belowfoldad_count",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "belowfoldad_count"
          },
          {
            "name": "inview_true_percent",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "inview_true_percent"
          },
          {
            "name": "activeviewtime_count",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "activeviewtime_count"
          },
          {
            "name": "activeviewtime_31secs",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "activeviewtime_31secs"
          },
          {
            "name": "activeviewtime_5_31secs",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "activeviewtime_5_31secs"
          },
          {
            "type": "calculated",
            "name": "smartmatch",
            "dataType": "int64",
            "isDataTypeInferred": true,
            "expression": "if(related(Advertisers[product_name])=\"SmartMatch (AA243)\" && Metrics[date_key] > 20180901,1,0)"
          }
        ],
        "partitions": [
          {
            "name": "20160501_20160630",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "where ",
                "    (date_key between  20160501 and 20160630)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "where ",
                  "    (date_key between  20160501 and 20160630)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20160701_20160831",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "where ",
                "   (date_key between  20160701 and 20160831)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "where ",
                  "   (date_key between  20160701 and 20160831)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20160901_20160930",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "where ",
                "   (date_key between  20160901 and 20160930)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "where ",
                  "   (date_key between  20160901 and 20160930)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20161001_20161031",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "where ",
                "   (date_key between  20161001 and 20161031)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "where ",
                  "   (date_key between  20161001 and 20161031)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20161101_20161130",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                "",
                " ",
                "where ",
                "  (date_key between  20161101 and 20161130)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  "",
                  " ",
                  "where ",
                  "  (date_key between  20161101 and 20161130)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20161201_20161231",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                "",
                "",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "  ",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                "",
                " ",
                "where ",
                " ",
                "  (date_key between  20161201 and 20161231)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  "",
                  "",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "  ",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  "",
                  " ",
                  "where ",
                  " ",
                  "  (date_key between  20161201 and 20161231)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170101_20170131",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                "",
                " ",
                "where ",
                " ",
                "  date_key between 20170101 and 20170131"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  "",
                  " ",
                  "where ",
                  " ",
                  "  date_key between 20170101 and 20170131</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170201_20170228",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                "",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "  ",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "",
                "where (date_key between  20170201 and 20170228)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  "",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "  ",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "",
                  "where (date_key between  20170201 and 20170228)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170301_20170331",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "",
                "where (date_key between  20170301 and 20170331)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "",
                  "where (date_key between  20170301 and 20170331)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170401_20170430",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "where (date_key between  20170401 and 20170430)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "where (date_key between  20170401 and 20170430)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170501_20170531",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "",
                "where  (date_key between  20170501 and 20170531)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "",
                  "where  (date_key between  20170501 and 20170531)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170601_20170630",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                " ",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "",
                "",
                "",
                "where  (date_key between  20170601 and 20170630)"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  " ",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "",
                  "",
                  "",
                  "where  (date_key between  20170601 and 20170630)</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170701_20170731",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                "",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs ",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "where  date_key between 20170701 and 20170731"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  "",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs ",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "where  date_key between 20170701 and 20170731</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170801_20170831",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                "",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs ",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key  ",
                "where  date_key between 20170801 and 20170831"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  "",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs ",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key  ",
                  "where  date_key between 20170801 and 20170831</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20170901_20170930",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                "",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs ",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                "where  date_key between 20170901 and 20170930"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  "",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs ",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key ",
                  "where  date_key between 20170901 and 20170930</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20171001_20171031",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                "",
                "",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs ",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key  ",
                "where  date_key between 20171001 and 20171031"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  "",
                  "",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs ",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key  ",
                  "where  date_key between 20171001 and 20171031</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20171101_20171209",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key  ",
                "where  date_key between 20171101 and 20171209"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key  ",
                  "where  date_key between 20171101 and 20171209</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20171210_20171231",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key  ",
                "where  date_key between 20171210 and 20171231"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions,activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key  ",
                  "where  date_key between 20171210 and 20171231</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20180101_20180131",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                "",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180101  and 20180131"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  "",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180101  and 20180131</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20180201_20180228",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180201  and 20180228"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180201  and 20180228</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20180301_20180331",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180301  and 20180331"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180301  and 20180331</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "missing",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key = 20180401"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key = 20180401</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20180401_20180430",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180401  and 20180430"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180401  and 20180430</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20180501_20180531",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180501  and 20180531"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180501  and 20180531</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20180601_20180630",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180601  and 20180630"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180601  and 20180630</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20180701_20180731",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180701  and 20180731"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180701  and 20180731</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "current",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180901  and 20180911"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180901  and 20180911</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          },
          {
            "name": "20180801_20180831",
            "mode": "import",
            "source": {
              "query": [
                "select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                "case",
                "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                "else ",
                "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                ",cast(cast(date_key || case",
                "                when fa.advertiser_key = -1 then 0",
                "                else fa.advertiser_key",
                "end as bigint) || case",
                "        when fa.creative_key = -1 then 0",
                "        else fa.creative_key",
                "        end as bigint) as tablekey",
                "",
                ",",
                "isnull(fa.pt, 'Unknown') as pt ",
                ",isnull(fa.res, 'Unknown') as res ",
                ",fa.slv",
                ",fa.industry,fa.position,fa.responsibility",
                " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                " , fa.gender",
                "",
                "",
                ", case",
                "when event_key = 0 then",
                "                    case",
                "                    when dfp_click_user_id is null then",
                "                                            case when dfp_click_erights_id is null then",
                "                                                                            case when fa.guid is null then ",
                "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                    else fa.spoor_id || date_key",
                "                                                                                                    end",
                "                                                                            else fa.guid || date_key ",
                "                                                                            end",
                "                                             else dfp_click_erights_id || date_key ",
                "                                             end",
                "                    else dfp_click_user_id || date_key ",
                "                    end",
                "else",
                "                    ",
                "                        case",
                "                        when dfp_impression_user_id is null then",
                "                                                                case when dfp_impression_erights_id is null then",
                "                                                                                                case when fa.guid is null then ",
                "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                "                                                                                                                        else fa.spoor_id || date_key",
                "                                                                                                                        end",
                "                                                                                                else fa.guid || date_key ",
                "                                                                                                end",
                "                                                                 else dfp_impression_erights_id || date_key ",
                "                                                                 end",
                "                            else dfp_impression_user_id || date_key ",
                "                            end",
                "end as user_id",
                "",
                ",fa.guid",
                ",fa.admant",
                ",fa.category",
                ", isnull(fa.krux_key,-1) as krux_key",
                ",fa.auuid",
                ",fa.activeview_eligibleimpression",
                ",fa.measurable_impression",
                ",fa.viewable_impression",
                ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                ",isnull(fm.inview_false, 0 ) as inview_false",
                ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                ",isnull(fm.scroll , 0 )as scroll",
                ",isnull(fm.scroll_count , 0 )as scroll_count",
                ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                ",isnull(fm.totalinteractions, 0) as totalinteractions",
                ",activeviewtime_count,",
                "activeviewtime_31secs,",
                "activeviewtime_5_31secs",
                "",
                "",
                "",
                "",
                "from ftdeepviewdb.facttable fa",
                "",
                "",
                "",
                " ",
                "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                "",
                " ",
                "where  date_key between 20180801  and 20180831"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
                  "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
                  "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
                  "case",
                  "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
                  "else ",
                  "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
                  ",cast(cast(date_key || case",
                  "                when fa.advertiser_key = -1 then 0",
                  "                else fa.advertiser_key",
                  "end as bigint) || case",
                  "        when fa.creative_key = -1 then 0",
                  "        else fa.creative_key",
                  "        end as bigint) as tablekey",
                  "",
                  ",",
                  "isnull(fa.pt, 'Unknown') as pt ",
                  ",isnull(fa.res, 'Unknown') as res ",
                  ",fa.slv",
                  ",fa.industry,fa.position,fa.responsibility",
                  " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
                  " , fa.gender",
                  "",
                  "",
                  ", case",
                  "when event_key = 0 then",
                  "                    case",
                  "                    when dfp_click_user_id is null then",
                  "                                            case when dfp_click_erights_id is null then",
                  "                                                                            case when fa.guid is null then ",
                  "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                    else fa.spoor_id || date_key",
                  "                                                                                                    end",
                  "                                                                            else fa.guid || date_key ",
                  "                                                                            end",
                  "                                             else dfp_click_erights_id || date_key ",
                  "                                             end",
                  "                    else dfp_click_user_id || date_key ",
                  "                    end",
                  "else",
                  "                    ",
                  "                        case",
                  "                        when dfp_impression_user_id is null then",
                  "                                                                case when dfp_impression_erights_id is null then",
                  "                                                                                                case when fa.guid is null then ",
                  "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
                  "                                                                                                                        else fa.spoor_id || date_key",
                  "                                                                                                                        end",
                  "                                                                                                else fa.guid || date_key ",
                  "                                                                                                end",
                  "                                                                 else dfp_impression_erights_id || date_key ",
                  "                                                                 end",
                  "                            else dfp_impression_user_id || date_key ",
                  "                            end",
                  "end as user_id",
                  "",
                  ",fa.guid",
                  ",fa.admant",
                  ",fa.category",
                  ", isnull(fa.krux_key,-1) as krux_key",
                  ",fa.auuid",
                  ",fa.activeview_eligibleimpression",
                  ",fa.measurable_impression",
                  ",fa.viewable_impression",
                  ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
                  ",isnull(fm.inview_false, 0 ) as inview_false",
                  ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
                  ",isnull(fm.totalinview_time , 0 )as totalinview_time",
                  ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
                  ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
                  ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
                  ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
                  ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
                  ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
                  ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
                  ",isnull(fm.scroll , 0 )as scroll",
                  ",isnull(fm.scroll_count , 0 )as scroll_count",
                  ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
                  ",isnull(fm.belowfoldad , 0 )as belowfoldad",
                  ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
                  ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
                  ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
                  ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
                  ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
                  ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
                  ",isnull(fm.totalinteractions, 0) as totalinteractions",
                  ",activeviewtime_count,",
                  "activeviewtime_31secs,",
                  "activeviewtime_5_31secs",
                  "",
                  "",
                  "",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "",
                  "",
                  "",
                  " ",
                  "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
                  "",
                  " ",
                  "where  date_key between 20180801  and 20180831</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "measures": [
          {
            "name": "CTR",
            "expression": "[Total Clicks]/[Total  Impressions]",
            "formatString": "0.00 %;-0.00 %;0.00 %"
          },
          {
            "name": "Known unique users",
            "expression": "DISTINCTCOUNT([guid]) + [distincterights]",
            "displayFolder": "Unique User Counts"
          },
          {
            "name": "Unknown unique users",
            "expression": "DISTINCTCOUNT([dfp_impression_user_id])",
            "displayFolder": "Unique User Counts"
          },
          {
            "name": "Distinct Count Clicks Erights Users",
            "expression": "DISTINCTCOUNT([dfp_click_erights_id])",
            "isHidden": true
          },
          {
            "name": "Distinct Count Clicks DFP Users",
            "expression": "DISTINCTCOUNT([dfp_click_user_id])",
            "isHidden": true
          },
          {
            "name": "Total impressions unknown users",
            "expression": "calculate(counta(metrics[date_key]),filter(metrics,or(metrics[guid]= \"UNKN\",metrics[guid]= blank())  && metrics[dfp_impression_erights_id] = blank()&& metrics[event_key] =1))",
            "displayFolder": "Known/Unknown Impressions"
          },
          {
            "name": "Total impressions known users",
            "expression": "if(sum(metrics[impressions]) - calculate(counta(metrics[date_key]),filter(metrics,or(metrics[guid]= \"UNKN\",metrics[guid]= blank()) )) < 0,0,sum(metrics[impressions]) - calculate(counta(metrics[date_key]),filter(metrics,or(metrics[guid]= \"UNKN\",metrics[guid]= blank()) )) )",
            "displayFolder": "Known/Unknown Impressions"
          },
          {
            "name": "Total clicks unknown users",
            "expression": "calculate(counta(metrics[date_key]),filter(metrics,or(metrics[guid]= \"UNKN\",metrics[guid]= blank())  && metrics[dfp_click_erights_id] = blank()&& metrics[event_key] =0))",
            "displayFolder": "Known/Unknown Impressions"
          },
          {
            "name": "Total clicks known users",
            "expression": "sum(metrics[clicks]) - calculate(counta(metrics[date_key]),filter(metrics,or(metrics[guid]= \"UNKN\",metrics[guid]= blank())  && metrics[dfp_click_erights_id] = blank() && metrics[event_key] =0))",
            "displayFolder": "Known/Unknown Impressions"
          },
          {
            "name": "Total  Impressions",
            "expression": "sum([Impressions])"
          },
          {
            "name": "Total Clicks",
            "expression": "SUM([Clicks])"
          },
          {
            "name": "All unique users",
            "expression": "[Known unique users]+[Unknown unique users]",
            "displayFolder": "Unique User Counts"
          },
          {
            "name": "Sum of Distinct Clicks",
            "expression": "[Distinct Count Clicks Erights Users]+[Distinct Count Clicks DFP Users]",
            "isHidden": true
          },
          {
            "name": "countofimpressions",
            "expression": "count([netcpm])",
            "isHidden": true
          },
          {
            "name": "Sell Through",
            "expression": "sum([netcpm])/[countofimpressions]",
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "MMX"
          },
          {
            "name": "eCPM_CPM",
            "expression": "sum([costperunit])/[Total  Impressions]*1000",
            "isHidden": true
          },
          {
            "name": "eCPM",
            "expression": [
              "if([eCPM_CPM] > 0, [eCPM_CPM],",
              "\t\t\t\tif([Total  Impressions] > 0,[net_value]/[Total  Impressions] * 1000, blank()))"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "isHidden": true,
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "SponsorshipRollup2",
            "expression": "[daterange]",
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "isHidden": true,
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "Revenue",
            "expression": "sum([costperunit])",
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "isHidden": true,
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "Total_Revenue1",
            "expression": "[revenue]+[sumxsponsorshiptotal]",
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "isHidden": true,
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "net_value",
            "expression": "max(Advertisers[net_value_gbp])/1000000",
            "isHidden": true
          },
          {
            "name": "datecalc",
            "expression": [
              "if(max([date_key]) - max(Advertisers[startdatekey]) +1 < 0, ",
              "\t\tblank(),max([date_key]) - min([date_key]) +1)"
            ],
            "isHidden": true
          },
          {
            "name": "CumulativeImpressions",
            "expression": [
              "CALCULATE (",
              "    SUM ( [Impressions] ),",
              "    FILTER  (ALLSELECTED(dates),'dates'[fulldate]  <=max(Dates[fulldate])",
              "    )",
              "\t",
              "\t)"
            ],
            "isHidden": true
          },
          {
            "name": "totalecpm",
            "expression": "if([Total  Impressions] > 0,[Combined_Revenue]/[Total  Impressions]*1000, blank())",
            "isHidden": true
          },
          {
            "name": "Total_Revenue",
            "expression": [
              "IF(COUNTROWS(VALUES(Dates[fulldate]))=1,",
              " [Total_Revenue1],",
              " SUMX(VALUES(dates[fulldate]), [Total_Revenue1])",
              "     ",
              ")"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "isHidden": true,
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "e_CPM2",
            "expression": [
              "IF(HASONEFILTER(Advertisers[line item name paid]),",
              "",
              "\tif([smartmatch_total] > 0,[totalecpm],",
              "\t\tif(max(advertisers[netvalueduration]) > 0 ,",
              "\t\t\t\t\t",
              "\t\t\t\t\tmax(advertisers[netvalueduration]) ",
              "\t\t\t\t\t*(if([CumulativeImpressions]> 0,[datecalc]/[CumulativeImpressions] * 1000,blank())),",
              "\t\t\t\t\t\tif([Total  Impressions]> 0,max(advertisers[net_rate_gbp]) /1000000,blank()))),\t\t",
              "\t\t\t\t\t[totalecpm])"
            ],
            "isHidden": true
          },
          {
            "name": "sumxsponsorshiptotal",
            "expression": "SUMX(VALUES(Advertisers[line item name paid]), [SponsorshipRollup2])",
            "isHidden": true
          },
          {
            "name": "daterange",
            "expression": [
              "if(min(dates[fulldate]) <max(advertisers[startdate]) ||  max(dates[fulldate])>max(advertisers[enddate]) ",
              ",0,sum(Advertisers[netvalueduration]))"
            ],
            "isHidden": true
          },
          {
            "name": "SPRrevenue",
            "expression": "sum([revenuecalc])",
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "isHidden": true,
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "Combined_Revenue",
            "expression": "[Revenue]+[SPRrevenue]",
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "displayFolder": "MMX",
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "e_CPM",
            "expression": [
              "IF(max(Advertisers[netrate])>0,",
              "",
              " if([Total  Impressions]>0, [Combined_Revenue]/[Total  Impressions] * 1000,blank()),",
              "   [e_CPM2]   ",
              ")"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "displayFolder": "MMX",
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "Viewable Impressions",
            "expression": [
              " ",
              "countx(filter(metrics,metrics[viewable_impression] = 1),metrics[viewable_impression])"
            ],
            "isHidden": true
          },
          {
            "name": "Active View Viewable Impressions %",
            "expression": "([Viewable Impressions]/[MeasurableImpressions] )",
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "isHidden": true
          },
          {
            "name": "Measurable Impressions1",
            "expression": " countx(filter(metrics,Metrics[measurable_impression] = -1),Metrics[measurable_impression])",
            "isHidden": true
          },
          {
            "name": "MeasurableImpressions",
            "expression": " countx(filter(metrics,Metrics[activeview_eligibleimpression] = 1),Metrics[activeview_eligibleimpression])-(countx(filter(metrics,Metrics[measurable_impression] = 0),Metrics[measurable_impression]) )",
            "isHidden": true
          },
          {
            "name": "activeinviewtime_percent%",
            "expression": [
              "if(sum([activeinviewtime]) = 0,0,",
              "if(isblank(sum([activeinviewtime])/sum([totalinview_time])  * 1000),0,sum([activeinviewtime])/sum([totalinview_time])  * 1000))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "isHidden": true,
            "displayFolder": "Moat/Active View"
          },
          {
            "name": "activeinviewtime_averages",
            "expression": "average([activeinviewtime_average])",
            "formatString": "0.00",
            "isHidden": true,
            "displayFolder": "Moat/Active View"
          },
          {
            "name": "scroll_percentage",
            "expression": [
              "",
              "",
              "if(sum([scroll]) = 0,blank(),",
              "if(isblank(sum([scroll])/count([scroll])),blank(),sum([scroll])/count([scroll])))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "isHidden": true,
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "activeinviewtime_total_secs",
            "expression": "sum([activeinviewtime])",
            "formatString": "0",
            "isHidden": true,
            "displayFolder": "Moat/Active View"
          },
          {
            "name": "totalinview_time_secs",
            "expression": "average([totalinview_time])",
            "formatString": "0.00",
            "isHidden": true,
            "displayFolder": "Moat"
          },
          {
            "name": "activepagedwell_content_secs",
            "expression": "sum([activepagedwell_content])/(sum([totalimpressionsunfiltered])- sum(Metrics[nht_totalimpressions]))",
            "formatString": "0",
            "isHidden": true,
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "belowfoldad_percent%",
            "expression": [
              "",
              "",
              "if(sum([belowfoldad]) = 0,blank(),",
              "if(ISBLANK(average([belowfoldad])),blank(),average([belowfoldad])))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "isHidden": true,
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "total_interactions",
            "expression": "sum([totalinteractions])",
            "formatString": "0",
            "isHidden": true,
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "e_CPM3",
            "expression": [
              "IF(HASONEFILTER(Advertisers[creative_name]),[totalecpm],",
              "\t\t[e_CPM2])"
            ],
            "isHidden": true
          },
          {
            "name": "e_CPM_old",
            "expression": "if([Total  Impressions]>0,[Combined_Revenue]/[Total  Impressions] * 1000,blank())",
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "isHidden": true,
            "displayFolder": "MMX",
            "annotations": [
              {
                "name": "Format",
                "value": "<Format Format=\"Currency\" Accuracy=\"2\"><Currency LCID=\"2057\" DisplayName=\"£ English (United Kingdom)\" Symbol=\"£\" PositivePattern=\"0\" NegativePattern=\"1\" /></Format>"
              }
            ]
          },
          {
            "name": "In-view %",
            "expression": [
              "if(sum([inview_true_percent]) = 0,blank(),",
              "if(isblank(sum([inview_true_percent])/sum([totalmeasurableimpressions])/100),blank(),sum([inview_true_percent])/sum([totalmeasurableimpressions])/100))",
              ""
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Basic"
          },
          {
            "name": "time until view avg secs",
            "expression": "average([timeuntilinview])",
            "formatString": "0.00",
            "isHidden": true,
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "IVT %",
            "expression": [
              "",
              "",
              "if(sum([nht_totalimpressions]) = 0,blank(),",
              "if(isblank(sum([nht_totalimpressions])/sum([nhtmeasurableimpressions]) ),blank(),sum([nht_totalimpressions])/sum([nhtmeasurableimpressions]) ))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Basic"
          },
          {
            "name": "interaction rate",
            "expression": [
              "if(calculate(SUMX(metrics,metrics[totalinteractions]),Metrics[res]=\"extra\"),blank(),",
              "if(isblank(calculate(SUMX(metrics,metrics[totalinteractions]),Metrics[res]=\"extra\"))/sum([totalinviewimpressions]),blank(),calculate(SUMX(metrics,metrics[totalinteractions]),Metrics[res]=\"extra\")/sum([totalinviewimpressions])))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "IVT_measurable_impressions",
            "expression": "sum([nhtmeasurableimpressions])",
            "formatString": "0",
            "isHidden": true,
            "displayFolder": "Moat/Invalid Traffic"
          },
          {
            "name": "IVT_impressions",
            "expression": "sum([nht_totalimpressions])",
            "formatString": "0",
            "isHidden": true,
            "displayFolder": "Moat/Invalid Traffic"
          },
          {
            "name": "Active 5s+ view%",
            "expression": "if(Metrics[activeinviewtime_count] = 0 ,blank(),(calculate(sum(Metrics[activeinviewtime]),filter(Metrics,Metrics[activeinviewtime]>5))/sum(Metrics[activeviewtime_count])/100))",
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT CPH"
          },
          {
            "name": "In-view%",
            "expression": [
              "if(sum([inview_true_percent]) = 0,blank(),",
              "if(isblank(sum([inview_true_percent])/sum([totalmeasurableimpressions])/100),blank(),sum([inview_true_percent])/sum([totalmeasurableimpressions])/100))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "In view Avg dwell time",
            "expression": "if(isblank(sum([totalinview_time])/sum([totalinviewimpressions]) /1000),0,sum([totalinview_time])/sum([totalinviewimpressions]) /1000)",
            "formatString": "0.00",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "IVT%",
            "expression": [
              "",
              "",
              "if(sum([nht_totalimpressions]) = 0,blank(),",
              "if(isblank(sum([nht_totalimpressions])/sum([nhtmeasurableimpressions]) ),blank(),sum([nht_totalimpressions])/sum([nhtmeasurableimpressions]) ))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "Total Active In-view 5s+ exposure time (hour)",
            "expression": "(calculate(sum(Metrics[activeinviewtime]),filter(Metrics,Metrics[activeinviewtime]>5))/60/60)",
            "formatString": "0",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT CPH"
          },
          {
            "name": "Active 5s+ Active In-view Avg dwell time (s)",
            "expression": "if(Metrics[activeinviewtime_count] = 0,blank(),(calculate(sum(Metrics[activeinviewtime]),filter(Metrics,Metrics[activeinviewtime]>5)))/(calculate(sum(Metrics[activeviewtime_count]),filter(Metrics,Metrics[activeinviewtime]>5))))",
            "formatString": "0.00",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT CPH"
          },
          {
            "name": "DFP impressions per Active 5s+ hour",
            "expression": "if(isblank([Total Active In-view 5s+ exposure time (hour)]),blank(),[Total  Impressions]/[Total Active In-view 5s+ exposure time (hour)])",
            "formatString": "0",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT CPH"
          },
          {
            "name": "Automated browser impressions",
            "expression": "sum(Metrics[automated_browser_rate])",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "Data centre impressions",
            "expression": "sum(Metrics[data_center_traffic_rate])",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "Incongruous browser impressions",
            "expression": "sum(Metrics[incongruous_browser_rate])",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "Is known spider impressions",
            "expression": "sum(Metrics[isknownspider_rate])",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "IVT measurable impressions",
            "expression": "sum(Metrics[nhtmeasurableimpressions])",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "In view exposure tim(mins)e",
            "expression": "sum([totalinview_time])/1000/3600",
            "formatString": "0",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "activeinview_time",
            "expression": "(calculate(sum(Metrics[activeinviewtime]),filter(Metrics,Metrics[activeinviewtime]>5)))",
            "isHidden": true
          },
          {
            "name": "activeinview_time_average",
            "expression": "(calculate(count(Metrics[activeinviewtime]),filter(Metrics,Metrics[activeinviewtime]>5)))",
            "isHidden": true
          },
          {
            "name": "activeinview_time_all",
            "expression": "calculate(sum(Metrics[activeinviewtime]))",
            "isHidden": true
          },
          {
            "name": "Total In-view exposure time(hrs)",
            "expression": "sum([totalinview_time])/1000/3600",
            "formatString": "0",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Basic"
          },
          {
            "name": "In-View 5s+ view%",
            "expression": "(calculate(sum(Metrics[totalinview_time]),filter(ALL(Metrics[totalinview_time]),Metrics[totalinview_time]>5000)))/count(Metrics[totalinview_time])/100/1000",
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT CPH"
          },
          {
            "name": "Active 5s+ Active In-view Avg dwell time (s_1)",
            "expression": "(calculate(sum(Metrics[activeinviewtime]),filter(Metrics,Metrics[activeinviewtime]>5)))/(calculate(count(Metrics[activeinviewtime])))",
            "isHidden": true
          },
          {
            "name": "In-view 5-31s exposure time (hour)",
            "expression": "(calculate(sum(Metrics[activeviewtime_5_31secs]) + sum(Metrics[activeviewtime_31secs])))/60/60",
            "formatString": "0.00",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT CPH"
          },
          {
            "name": "In-View 5-31s Avg dwell time (s))",
            "expression": "(sum(Metrics[activeviewtime_5_31secs]) + sum(Metrics[activeviewtime_31secs]))/count(Metrics[activeviewtime_5_31secs]) ",
            "formatString": "0.00",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT CPH"
          },
          {
            "name": "DFP impressions per In-View 5-31s hour",
            "expression": "if(isblank([In-view 5-31s exposure time (hour)]),blank(),[Total  Impressions]/[In-view 5-31s exposure time (hour)])",
            "formatString": "0",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT CPH"
          },
          {
            "name": "activeinviewtime_count",
            "expression": " sum(Metrics[activeviewtime_count])",
            "isHidden": true
          },
          {
            "name": "In-view Avg dwell time(s)",
            "expression": "sum([totalinview_time])/sum([totalinviewimpressions]) /1000",
            "formatString": "0.00",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Basic"
          },
          {
            "name": "Automated browser%",
            "expression": [
              "",
              "if(sum([automated_browser_rate]) = 0,blank(),",
              "if(ISBLANK(sum([automated_browser_rate])/sum([nhtmeasurableimpressions])),blank(),sum([automated_browser_rate])/sum([nhtmeasurableimpressions])))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "Incongruous browser%",
            "expression": [
              "",
              "",
              "if(sum([incongruous_browser_rate]) = 0,blank(),",
              "if(isblank(sum([incongruous_browser_rate])/sum([nhtmeasurableimpressions])),blank(),sum([incongruous_browser_rate])/sum([nhtmeasurableimpressions])))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "Data centre%",
            "expression": [
              "",
              "",
              "if(sum([data_center_traffic_rate]) = 0,blank(),",
              "if(isblank(sum([data_center_traffic_rate])/sum([nhtmeasurableimpressions])),blank(),sum([data_center_traffic_rate])/sum([nhtmeasurableimpressions])))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "Is known spider%",
            "expression": [
              "",
              "",
              "if(sum([isknownspider_rate]) = 0,blank(),",
              "if(isblank(sum([isknownspider_rate])/sum([nhtmeasurableimpressions])),blank(),sum([isknownspider_rate])/sum([nhtmeasurableimpressions])))"
            ],
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "Total in-view impressions",
            "expression": "sum([totalinviewimpressions])",
            "formatString": "0",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "Total measurable impressions",
            "expression": "sum([totalmeasurableimpressions])",
            "formatString": "0",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "Total impressions unfiltered",
            "expression": "sum([totalimpressionsunfiltered])",
            "formatString": "0",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "MOAT to DFP Measurable rate",
            "expression": "[Total measurable impressions]/[Total  Impressions]",
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced in-view"
          },
          {
            "name": "IVT total Impressions",
            "expression": "sum(Metrics[nht_totalimpressions])",
            "displayFolder": "3rd  PARTY ATTENTION & IVT FOLDER\\MOAT Advanced Metrics\\MOAT Advanced Invalid Traffic"
          },
          {
            "name": "test_interaction",
            "expression": " calculate(SUMX(metrics,metrics[totalinteractions]),Metrics[res]=\"extra\")/sum([totalinviewimpressions])",
            "formatString": "0.00 %;-0.00 %;0.00 %",
            "isHidden": true
          },
          {
            "name": "test_interaction1",
            "expression": " calculate(SUMX(metrics,metrics[total_interactions]),Metrics[res]=\"extra\")",
            "isHidden": true
          },
          {
            "name": "distincterights",
            "expression": " calculate(DISTINCTCOUNT(Metrics[dfp_impression_erights_id]),filter(metrics,or(metrics[guid]= \"UNKN\",metrics[guid]= blank())  && metrics[event_key] =1))",
            "isHidden": true
          },
          {
            "name": "e_CPM4",
            "expression": [
              "IF(HASONEFILTER(Advertisers[line item name paid]),",
              "\t\t\"filter\",\t\t",
              "\t\t\t\t\t\"no filter\")",
              ""
            ],
            "isHidden": true
          },
          {
            "name": "netvaluedduration",
            "expression": "max(advertisers[netvalueduration])",
            "isHidden": true
          },
          {
            "name": "maxdatekey",
            "expression": "max([date_key]) ",
            "isHidden": true
          },
          {
            "name": "smartmatch_total",
            "expression": " sum(Metrics[smartmatch])",
            "isHidden": true
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "factsummary"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select top 1   time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
              "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
              "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
              "case",
              "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
              "else ",
              "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
              ",cast(cast(date_key || case",
              "                when fa.advertiser_key = -1 then 0",
              "                else fa.advertiser_key",
              "end as bigint) || case",
              "        when fa.creative_key = -1 then 0",
              "        else fa.creative_key",
              "        end as bigint) as tablekey",
              "",
              ",",
              "isnull(fa.pt, 'Unknown') as pt ",
              ",isnull(fa.res, 'Unknown') as res ",
              ",fa.slv",
              ",fa.industry,fa.position,fa.responsibility",
              " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
              " , fa.gender",
              "",
              "",
              ", case",
              "when event_key = 0 then",
              "                    case",
              "                    when dfp_click_user_id is null then",
              "                                            case when dfp_click_erights_id is null then",
              "                                                                            case when fa.guid is null then ",
              "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
              "                                                                                                    else fa.spoor_id || date_key",
              "                                                                                                    end",
              "                                                                            else fa.guid || date_key ",
              "                                                                            end",
              "                                             else dfp_click_erights_id || date_key ",
              "                                             end",
              "                    else dfp_click_user_id || date_key ",
              "                    end",
              "else",
              "                    ",
              "                        case",
              "                        when dfp_impression_user_id is null then",
              "                                                                case when dfp_impression_erights_id is null then",
              "                                                                                                case when fa.guid is null then ",
              "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
              "                                                                                                                        else fa.spoor_id || date_key",
              "                                                                                                                        end",
              "                                                                                                else fa.guid || date_key ",
              "                                                                                                end",
              "                                                                 else dfp_impression_erights_id || date_key ",
              "                                                                 end",
              "                            else dfp_impression_user_id || date_key ",
              "                            end",
              "end as user_id",
              "",
              ",fa.guid",
              ",fa.admant",
              ",fa.category",
              ", isnull(fa.krux_key,-1) as krux_key",
              ",fa.auuid",
              ",fa.activeview_eligibleimpression",
              ",fa.measurable_impression",
              ",fa.viewable_impression",
              ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
              ",isnull(fm.inview_false, 0 ) as inview_false",
              ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
              ",isnull(fm.totalinview_time , 0 )as totalinview_time",
              ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
              ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
              ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
              ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
              ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
              ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
              ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
              ",isnull(fm.scroll , 0 )as scroll",
              ",isnull(fm.scroll_count , 0 )as scroll_count",
              ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
              ",isnull(fm.belowfoldad , 0 )as belowfoldad",
              ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
              ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
              ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
              ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
              ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
              ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
              ",isnull(fm.totalinteractions, 0) as totalinteractions",
              ",activeviewtime_count,",
              "activeviewtime_31secs,",
              "activeviewtime_5_31secs",
              "",
              "",
              "",
              "from ftdeepviewdb.facttable fa",
              "",
              "",
              "",
              " ",
              "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
              "",
              " ",
              "where  date_key between 20171107  and 20171108"
            ]
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select top 1   time_key, date_key, imp_demos_key, user_demos_key,  advertiser_key, category_key, value,  ",
              "dfp_click_user_id, dfp_impression_user_id, dfp_impression_erights_id, dfp_click_erights_id, ",
              "event_key, ad_unit_key,  country_key,fa.creative_key ,isnull(fa.ad_position ,'Unknown')  as ad_position,isnull(fa.creative_size,'Unknown') as creative_size,",
              "case",
              "when fa.creative_key = -1 or fa.creative_key is null then isnull(cast(fa.advertiser_key as varchar), '-1')",
              "else ",
              "cast(fa.creative_key as varchar)|| cast(fa.advertiser_key as varchar) end  as adcreative_key",
              ",cast(cast(date_key || case",
              "                when fa.advertiser_key = -1 then 0",
              "                else fa.advertiser_key",
              "end as bigint) || case",
              "        when fa.creative_key = -1 then 0",
              "        else fa.creative_key",
              "        end as bigint) as tablekey",
              "",
              ",",
              "isnull(fa.pt, 'Unknown') as pt ",
              ",isnull(fa.res, 'Unknown') as res ",
              ",fa.slv",
              ",fa.industry,fa.position,fa.responsibility",
              " ,fa.responsibility + '_' + fa.position  + '_' + fa.industry as SegmentID",
              " , fa.gender",
              "",
              "",
              ", case",
              "when event_key = 0 then",
              "                    case",
              "                    when dfp_click_user_id is null then",
              "                                            case when dfp_click_erights_id is null then",
              "                                                                            case when fa.guid is null then ",
              "                                                                                                         case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
              "                                                                                                    else fa.spoor_id || date_key",
              "                                                                                                    end",
              "                                                                            else fa.guid || date_key ",
              "                                                                            end",
              "                                             else dfp_click_erights_id || date_key ",
              "                                             end",
              "                    else dfp_click_user_id || date_key ",
              "                    end",
              "else",
              "                    ",
              "                        case",
              "                        when dfp_impression_user_id is null then",
              "                                                                case when dfp_impression_erights_id is null then",
              "                                                                                                case when fa.guid is null then ",
              "                                                                                                                             case when (fa.spoor_id is null or fa.spoor_id = 'UNKN')  then  null",
              "                                                                                                                        else fa.spoor_id || date_key",
              "                                                                                                                        end",
              "                                                                                                else fa.guid || date_key ",
              "                                                                                                end",
              "                                                                 else dfp_impression_erights_id || date_key ",
              "                                                                 end",
              "                            else dfp_impression_user_id || date_key ",
              "                            end",
              "end as user_id",
              "",
              ",fa.guid",
              ",fa.admant",
              ",fa.category",
              ", isnull(fa.krux_key,-1) as krux_key",
              ",fa.auuid",
              ",fa.activeview_eligibleimpression",
              ",fa.measurable_impression",
              ",fa.viewable_impression",
              ",isnull(fm.inview_true_percent, 0 ) as inview_true_percent",
              ",isnull(fm.inview_false, 0 ) as inview_false",
              ",isnull(fm.totalinviewtime_average , 0 )as totalinviewtime_average",
              ",isnull(fm.totalinview_time , 0 )as totalinview_time",
              ",isnull(fm.activeinviewtime, 0 ) as activeinviewtime",
              ",isnull(fm.activeinviewtime_average,0 ) as activeinviewtime_average",
              ",isnull(fm.automated_browser_rate, 0 ) as automated_browser_rate",
              ",isnull(fm.incongruous_browser_rate, 0 ) as incongruous_browser_rate",
              ",isnull(fm.data_center_traffic_rate, 0 ) as data_center_traffic_rate",
              ",isnull(fm.isknownspider_rate, 0 ) as isknownspider_rate",
              ",isnull(fm.activepagedwell_content, 0 ) as activepagedwell_content",
              ",isnull(fm.scroll , 0 )as scroll",
              ",isnull(fm.scroll_count , 0 )as scroll_count",
              ",isnull(fm.timeuntilinview , 0 )as timeuntilinview",
              ",isnull(fm.belowfoldad , 0 )as belowfoldad",
              ",isnull(fm.belowfoldad_count, 0) as belowfoldad_count",
              ",isnull(fm.totalinviewimpressions, 0 ) as totalinviewimpressions",
              ",isnull(fm.totalmeasurableimpressions, 0 ) as totalmeasurableimpressions",
              ",isnull(fm.totalimpressionsunfiltered, 0 ) as totalimpressionsunfiltered",
              ",isnull(fm.nhtmeasurableimpressions, 0 ) as nhtmeasurableimpressions",
              ",isnull(fm.nht_totalimpressions, 0 ) as nht_totalimpressions",
              ",isnull(fm.totalinteractions, 0) as totalinteractions",
              ",activeviewtime_count,",
              "activeviewtime_31secs,",
              "activeviewtime_5_31secs",
              "",
              "",
              "",
              "from ftdeepviewdb.facttable fa",
              "",
              "",
              "",
              " ",
              "left join ftdeepviewdb.facttable_moat fm on fm.key = fa.moat_key",
              "",
              " ",
              "where  date_key between 20171107  and 20171108</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "Dates",
        "columns": [
          {
            "name": "datekey",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "datekey"
          },
          {
            "name": "fulldate",
            "dataType": "dateTime",
            "sourceColumn": "fulldate",
            "formatString": "General Date",
            "sortByColumn": "datekey"
          },
          {
            "name": "fulldatename",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "fulldatename"
          },
          {
            "name": "dayofweekkey",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "dayofweekkey"
          },
          {
            "name": "dayofweek",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dayofweek",
            "sortByColumn": "dayofweekkey"
          },
          {
            "name": "dayofweekshort",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "dayofweekshort"
          },
          {
            "name": "weekofyear",
            "dataType": "int64",
            "sourceColumn": "weekofyear"
          },
          {
            "name": "calendaryearmonth",
            "dataType": "string",
            "sourceColumn": "calendaryearmonth"
          },
          {
            "name": "week",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "week"
          },
          {
            "name": "monthofyear",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "monthofyear"
          },
          {
            "name": "calendarmonth",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "calendarmonth"
          },
          {
            "name": "calendaryear",
            "dataType": "int64",
            "sourceColumn": "calendaryear"
          },
          {
            "name": "year",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "year"
          },
          {
            "name": "weekstartdate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "weekstartdate",
            "formatString": "General Date"
          },
          {
            "name": "weekenddate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "weekenddate",
            "formatString": "General Date"
          },
          {
            "name": "relativeweekskey",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "relativeweekskey"
          },
          {
            "name": "weekcommencing",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "weekcommencing",
            "formatString": "General Date"
          },
          {
            "name": "weekending",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "weekending",
            "formatString": "General Date"
          },
          {
            "name": "relativeyearskey",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "relativeyearskey"
          },
          {
            "name": "calendarmonthofyear",
            "dataType": "string",
            "sourceColumn": "calendarmonthofyear",
            "sortByColumn": "monthofyear"
          },
          {
            "name": "calendarmonthofyearshort",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "calendarmonthofyearshort"
          },
          {
            "name": "datenameeu",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "datenameeu"
          },
          {
            "name": "dayofmonth",
            "dataType": "int64",
            "sourceColumn": "dayofmonth"
          },
          {
            "name": "fiscalweekofyear",
            "dataType": "int64",
            "sourceColumn": "fiscalweekofyear"
          }
        ],
        "partitions": [
          {
            "name": "Dates",
            "source": {
              "query": [
                "SELECT datekey, ",
                "fulldate, ",
                "fulldatename, ",
                "dayofweek as dayofweekkey, ",
                "daynameofweek as dayofweek, ",
                "daynameofweekabbreviated as dayofweekshort, ",
                "weekofyear, ",
                "calendaryearmonth, ",
                "weekofyearname as week, ",
                "monthofyear, ",
                "monthofyearname as calendarmonth, ",
                "--calendarmonthofyearshort, ",
                "calendaryear, ",
                "fiscalyear as year, ",
                "weekstartdate, ",
                "weekenddate, ",
                "--yearstartdate, ",
                "--yearenddate, ",
                "relativeweeks as relativeweekskey, ",
                "--week, ",
                "weekstartdate as weekcommencing, ",
                "weekenddate as weekending, ",
                "relativeyears as relativeyearskey,fiscalweekofyear, ",
                "--calendarmonthkey, ",
                "monthname as calendarmonthofyear, ",
                "monthnameabbreviated as calendarmonthofyearshort,",
                "datenameeu ,",
                "dayofmonth",
                "FROM ftmicoredb.dim_date",
                "where calendaryear between 2013 and datepart(year,getdate())"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT datekey, ",
                  "fulldate, ",
                  "fulldatename, ",
                  "dayofweek as dayofweekkey, ",
                  "daynameofweek as dayofweek, ",
                  "daynameofweekabbreviated as dayofweekshort, ",
                  "weekofyear, ",
                  "calendaryearmonth, ",
                  "weekofyearname as week, ",
                  "monthofyear, ",
                  "monthofyearname as calendarmonth, ",
                  "--calendarmonthofyearshort, ",
                  "calendaryear, ",
                  "fiscalyear as year, ",
                  "weekstartdate, ",
                  "weekenddate, ",
                  "--yearstartdate, ",
                  "--yearenddate, ",
                  "relativeweeks as relativeweekskey, ",
                  "--week, ",
                  "weekstartdate as weekcommencing, ",
                  "weekenddate as weekending, ",
                  "relativeyears as relativeyearskey,fiscalweekofyear, ",
                  "--calendarmonthkey, ",
                  "monthname as calendarmonthofyear, ",
                  "monthnameabbreviated as calendarmonthofyearshort,",
                  "datenameeu ,",
                  "dayofmonth",
                  "FROM ftmicoredb.dim_date",
                  "where calendaryear between 2013 and datepart(year,getdate())</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "hierarchies": [
          {
            "name": "Standard Calendar",
            "levels": [
              {
                "name": "calendaryear",
                "ordinal": 0,
                "column": "calendaryear"
              },
              {
                "name": "calendaryearmonth",
                "ordinal": 1,
                "column": "calendaryearmonth"
              },
              {
                "name": "fulldate",
                "ordinal": 2,
                "column": "fulldate"
              }
            ]
          },
          {
            "name": "Day of Week",
            "levels": [
              {
                "name": "dayofweek",
                "ordinal": 0,
                "column": "dayofweek"
              }
            ]
          },
          {
            "name": "Business Calendar",
            "levels": [
              {
                "name": "calendaryear",
                "ordinal": 0,
                "column": "calendaryear"
              },
              {
                "name": "calendarmonthofyear",
                "ordinal": 1,
                "column": "calendarmonthofyear"
              },
              {
                "name": "weekofyear",
                "ordinal": 2,
                "column": "weekofyear"
              },
              {
                "name": "dayofmonth",
                "ordinal": 3,
                "column": "dayofmonth"
              }
            ]
          },
          {
            "name": "Fiscal Week",
            "levels": [
              {
                "name": "fiscalweekofyear",
                "ordinal": 0,
                "column": "fiscalweekofyear"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Dates"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "SELECT datekey, ",
              "fulldate, ",
              "fulldatename, ",
              "dayofweek as dayofweekkey, ",
              "daynameofweek as dayofweek, ",
              "daynameofweekabbreviated as dayofweekshort, ",
              "weekofyear, ",
              "calendaryearmonth, ",
              "weekofyearname as week, ",
              "monthofyear, ",
              "monthofyearname as calendarmonth, ",
              "--calendarmonthofyearshort, ",
              "calendaryear, ",
              "fiscalyear as year, ",
              "weekstartdate, ",
              "weekenddate, ",
              "--yearstartdate, ",
              "--yearenddate, ",
              "relativeweeks as relativeweekskey, ",
              "--week, ",
              "weekstartdate as weekcommencing, ",
              "weekenddate as weekending, ",
              "relativeyears as relativeyearskey,fiscalweekofyear, ",
              "--calendarmonthkey, ",
              "monthname as calendarmonthofyear, ",
              "monthnameabbreviated as calendarmonthofyearshort,",
              "datenameeu ,",
              "dayofmonth",
              "FROM ftmicoredb.dim_date",
              "where calendaryear between 2013 and datepart(year,getdate())"
            ]
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT datekey, ",
              "fulldate, ",
              "fulldatename, ",
              "dayofweek as dayofweekkey, ",
              "daynameofweek as dayofweek, ",
              "daynameofweekabbreviated as dayofweekshort, ",
              "weekofyear, ",
              "calendaryearmonth, ",
              "weekofyearname as week, ",
              "monthofyear, ",
              "monthofyearname as calendarmonth, ",
              "--calendarmonthofyearshort, ",
              "calendaryear, ",
              "fiscalyear as year, ",
              "weekstartdate, ",
              "weekenddate, ",
              "--yearstartdate, ",
              "--yearenddate, ",
              "relativeweeks as relativeweekskey, ",
              "--week, ",
              "weekstartdate as weekcommencing, ",
              "weekenddate as weekending, ",
              "relativeyears as relativeyearskey,fiscalweekofyear, ",
              "--calendarmonthkey, ",
              "monthname as calendarmonthofyear, ",
              "monthnameabbreviated as calendarmonthofyearshort,",
              "datenameeu ,",
              "dayofmonth",
              "FROM ftmicoredb.dim_date",
              "where calendaryear between 2013 and datepart(year,getdate())</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "DailyCounts",
        "isHidden": true,
        "columns": [
          {
            "name": "tablekey",
            "dataType": "int64",
            "sourceColumn": "tablekey"
          },
          {
            "name": "date_key",
            "dataType": "int64",
            "sourceColumn": "date_key"
          },
          {
            "name": "advertiser_key",
            "dataType": "int64",
            "sourceColumn": "advertiser_key"
          },
          {
            "name": "netvalue",
            "dataType": "double",
            "sourceColumn": "netvalue"
          },
          {
            "name": "duration",
            "dataType": "int64",
            "sourceColumn": "duration"
          },
          {
            "name": "dailyrevenue",
            "dataType": "double",
            "sourceColumn": "dailyrevenue"
          },
          {
            "name": "rowcount",
            "dataType": "int64",
            "sourceColumn": "rowcount"
          },
          {
            "name": "netrate",
            "dataType": "double",
            "sourceColumn": "netrate"
          },
          {
            "name": "calc1",
            "dataType": "double",
            "sourceColumn": "calc1"
          },
          {
            "name": "costmodel",
            "dataType": "string",
            "sourceColumn": "costmodel"
          },
          {
            "name": "creative_key",
            "dataType": "int64",
            "sourceColumn": "creative_key"
          },
          {
            "name": "maxrowcount",
            "dataType": "int64",
            "sourceColumn": "maxrowcount"
          },
          {
            "name": "creative_name",
            "dataType": "string",
            "sourceColumn": "creative_name"
          }
        ],
        "partitions": [
          {
            "name": "DailyCounts",
            "source": {
              "query": "select * from ftdeepviewdb.dailycounts_creatives",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select * from ftdeepviewdb.dailycounts_creatives</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "DailyCounts"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select * from ftdeepviewdb.dailycounts_creatives"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select * from ftdeepviewdb.dailycounts_creatives</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "Users_Impressions",
        "columns": [
          {
            "name": "id",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "id"
          },
          {
            "name": "userstatus",
            "dataType": "string",
            "sourceColumn": "userstatus"
          }
        ],
        "partitions": [
          {
            "name": "Users",
            "source": {
              "query": [
                "select 0 as id, 'Unknown Users Impressions' as UserStatus",
                "union",
                "select 1 , 'Known Users Impressions'"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization"
              },
              {
                "name": "TableWidgetSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Users"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select 0 as id, 'Unknown Users Impressions' as UserStatus",
              "union",
              "select 1 , 'Known Users Impressions'"
            ]
          }
        ]
      },
      {
        "name": "Creatives",
        "columns": [
          {
            "name": "creative_size",
            "dataType": "string",
            "sourceColumn": "creative_size"
          }
        ],
        "partitions": [
          {
            "name": "Creatives",
            "source": {
              "query": "select distinct isnull(creative_size, 'Unknown') as Creative_Size from ftdeepviewdb.facttable",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "TableWidgetSerialization"
              },
              {
                "name": "TableWidgetSourceTable"
              },
              {
                "name": "QueryEditorSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Creatives"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select distinct isnull(creative_size, 'Unknown') as Creative_Size from ftdeepviewdb.facttable"
          }
        ]
      },
      {
        "name": "Ad_Position",
        "columns": [
          {
            "name": "ad_position",
            "dataType": "string",
            "sourceColumn": "ad_position"
          }
        ],
        "partitions": [
          {
            "name": "Ad Position",
            "source": {
              "query": "select distinct isnull(ad_position, 'Unknown') as Ad_Position from ftdeepviewdb.facttable",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "TableWidgetSerialization"
              },
              {
                "name": "TableWidgetSourceTable"
              },
              {
                "name": "QueryEditorSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Ad Position"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select distinct isnull(ad_position, 'Unknown') as Ad_Position from ftdeepviewdb.facttable"
          }
        ]
      },
      {
        "name": "Page_Type",
        "columns": [
          {
            "name": "page_type",
            "dataType": "string",
            "sourceColumn": "page_type"
          }
        ],
        "partitions": [
          {
            "name": "Page_Type",
            "source": {
              "query": "select distinct isnull(pt, 'Unknown') as Page_Type from ftdeepviewdb.facttable",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "TableWidgetSerialization"
              },
              {
                "name": "TableWidgetSourceTable"
              },
              {
                "name": "QueryEditorSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Page_Type"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select distinct isnull(pt, 'Unknown') as Page_Type from ftdeepviewdb.facttable"
          }
        ]
      },
      {
        "name": "Res",
        "columns": [
          {
            "name": "res",
            "dataType": "string",
            "sourceColumn": "res"
          }
        ],
        "partitions": [
          {
            "name": "Res",
            "source": {
              "query": "select distinct isnull(res, 'Unknown') as Res from ftdeepviewdb.facttable",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "TableWidgetSerialization"
              },
              {
                "name": "TableWidgetSourceTable"
              },
              {
                "name": "QueryEditorSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Res"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select distinct isnull(res, 'Unknown') as Res from ftdeepviewdb.facttable"
          }
        ]
      },
      {
        "name": "SLV",
        "columns": [
          {
            "name": "slv",
            "dataType": "string",
            "sourceColumn": "slv"
          }
        ],
        "partitions": [
          {
            "name": "SLV",
            "source": {
              "query": "select distinct isnull(slv, 'UNKN') as slv from ftadvertdb.dfp_impressions",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization"
              },
              {
                "name": "TableWidgetSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "SLV"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select distinct isnull(slv, 'UNKN') as slv from ftadvertdb.dfp_impressions"
          }
        ]
      },
      {
        "name": "DT_Industry",
        "columns": [
          {
            "name": "industry_full",
            "dataType": "string",
            "sourceColumn": "industry_full",
            "displayFolder": "DT Demographics"
          },
          {
            "name": "industry_abv",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "industry_abv"
          }
        ],
        "partitions": [
          {
            "name": "DT_Industry",
            "source": {
              "query": [
                "select  distinct",
                " isnull(dt.industry_abv,'UNKN') as industry_abv",
                "--,",
                "--isnull(dt.industry_full,'Unknown') as industry_full",
                ",case",
                "when fa.industry ='' then 'Unknown'",
                "when fa.industry  is null then 'Unknown'",
                "else isnull(dt.industry_full, 'Unknown')  ",
                "end as industry_full",
                "from ftdeepviewdb.facttable fa",
                "left join ftdeepviewdb.dt_demographics dt on dt.industry_abv = fa.industry"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  distinct",
                  " isnull(dt.industry_abv,'UNKN') as industry_abv",
                  "--,",
                  "--isnull(dt.industry_full,'Unknown') as industry_full",
                  ",case",
                  "when fa.industry ='' then 'Unknown'",
                  "when fa.industry  is null then 'Unknown'",
                  "else isnull(dt.industry_full, 'Unknown')  ",
                  "end as industry_full",
                  "from ftdeepviewdb.facttable fa",
                  "left join ftdeepviewdb.dt_demographics dt on dt.industry_abv = fa.industry</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "DT_Industry"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select  distinct",
              " isnull(dt.industry_abv,'UNKN') as industry_abv",
              "--,",
              "--isnull(dt.industry_full,'Unknown') as industry_full",
              ",case",
              "when fa.industry ='' then 'Unknown'",
              "when fa.industry  is null then 'Unknown'",
              "else isnull(dt.industry_full, 'Unknown')  ",
              "end as industry_full",
              "from ftdeepviewdb.facttable fa",
              "left join ftdeepviewdb.dt_demographics dt on dt.industry_abv = fa.industry"
            ]
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  distinct",
              " isnull(dt.industry_abv,'UNKN') as industry_abv",
              "--,",
              "--isnull(dt.industry_full,'Unknown') as industry_full",
              ",case",
              "when fa.industry ='' then 'Unknown'",
              "when fa.industry  is null then 'Unknown'",
              "else isnull(dt.industry_full, 'Unknown')  ",
              "end as industry_full",
              "from ftdeepviewdb.facttable fa",
              "left join ftdeepviewdb.dt_demographics dt on dt.industry_abv = fa.industry</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "Users Clicks",
        "columns": [
          {
            "name": "id",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "id"
          },
          {
            "name": "userstatus",
            "dataType": "string",
            "sourceColumn": "userstatus"
          }
        ],
        "partitions": [
          {
            "name": "Users Clicks",
            "source": {
              "query": [
                "select 0 as id, 'Unknown Users Clicks' as UserStatus",
                "union",
                "select 1 , 'Known Users Clicks'"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization"
              },
              {
                "name": "TableWidgetSerialization"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Users Clicks"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select 0 as id, 'Unknown Users Clicks' as UserStatus",
              "union",
              "select 1 , 'Known Users Clicks'"
            ]
          }
        ]
      },
      {
        "name": "DT_position",
        "columns": [
          {
            "name": "position_abv",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "position_abv"
          },
          {
            "name": "position_full",
            "dataType": "string",
            "sourceColumn": "position_full"
          }
        ],
        "partitions": [
          {
            "name": "DT_position",
            "source": {
              "query": [
                "select  distinct",
                "isnull(dt.position_abv,'UNKN') as position_abv",
                ",case",
                "when fa.position ='' then 'Unknown'",
                "when fa.position  is null then 'Unknown'",
                "else isnull(dt.position_full, 'Unknown')  ",
                "end as position_full",
                "from ftdeepviewdb.facttable fa",
                "left join ftdeepviewdb.dt_demographics dt on dt.position_abv = fa.position"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  distinct",
                  "isnull(dt.position_abv,'UNKN') as position_abv",
                  ",case",
                  "when fa.position ='' then 'Unknown'",
                  "when fa.position  is null then 'Unknown'",
                  "else isnull(dt.position_full, 'Unknown')  ",
                  "end as position_full",
                  "from ftdeepviewdb.facttable fa",
                  "left join ftdeepviewdb.dt_demographics dt on dt.position_abv = fa.position</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "DT_position"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select  distinct",
              "isnull(dt.position_abv,'UNKN') as position_abv",
              ",case",
              "when fa.position ='' then 'Unknown'",
              "when fa.position  is null then 'Unknown'",
              "else isnull(dt.position_full, 'Unknown')  ",
              "end as position_full",
              "from ftdeepviewdb.facttable fa",
              "left join ftdeepviewdb.dt_demographics dt on dt.position_abv = fa.position"
            ]
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  distinct",
              "isnull(dt.position_abv,'UNKN') as position_abv",
              ",case",
              "when fa.position ='' then 'Unknown'",
              "when fa.position  is null then 'Unknown'",
              "else isnull(dt.position_full, 'Unknown')  ",
              "end as position_full",
              "from ftdeepviewdb.facttable fa",
              "left join ftdeepviewdb.dt_demographics dt on dt.position_abv = fa.position</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "DT_responsibility",
        "columns": [
          {
            "name": "responsibility_abv",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "responsibility_abv"
          },
          {
            "name": "responsibility_full",
            "dataType": "string",
            "sourceColumn": "responsibility_full",
            "displayFolder": "DT Demographics"
          }
        ],
        "partitions": [
          {
            "name": "DT_responsibility",
            "source": {
              "query": [
                "select  distinct",
                "case",
                "when  dt.responsibility_abv is null then isnull(fa.responsibility,'UNKN')",
                "when dt.responsibility_abv = '' then 'UNKN'",
                "else dt.responsibility_abv",
                "end as responsibility_abv",
                ",case",
                "when fa.responsibility ='' then 'Unknown'",
                "when fa.responsibility  is null then 'Unknown'",
                "when  dt.responsibility_abv is null then 'Unknown'  ",
                "",
                "else dt.responsibility_full",
                "end as responsibility_full",
                "",
                "from ftdeepviewdb.facttable fa",
                "left join ftdeepviewdb.dt_demographics dt on dt.responsibility_abv = fa.responsibility"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  distinct",
                  "case",
                  "when  dt.responsibility_abv is null then isnull(fa.responsibility,'UNKN')",
                  "when dt.responsibility_abv = '' then 'UNKN'",
                  "else dt.responsibility_abv",
                  "end as responsibility_abv",
                  ",case",
                  "when fa.responsibility ='' then 'Unknown'",
                  "when fa.responsibility  is null then 'Unknown'",
                  "when  dt.responsibility_abv is null then 'Unknown'  ",
                  "",
                  "else dt.responsibility_full",
                  "end as responsibility_full",
                  "",
                  "from ftdeepviewdb.facttable fa",
                  "left join ftdeepviewdb.dt_demographics dt on dt.responsibility_abv = fa.responsibility</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "DT_responsibility"
          },
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select  distinct",
              "case",
              "when  dt.responsibility_abv is null then isnull(fa.responsibility,'UNKN')",
              "when dt.responsibility_abv = '' then 'UNKN'",
              "else dt.responsibility_abv",
              "end as responsibility_abv",
              ",case",
              "when fa.responsibility ='' then 'Unknown'",
              "when fa.responsibility  is null then 'Unknown'",
              "when  dt.responsibility_abv is null then 'Unknown'  ",
              "",
              "else dt.responsibility_full",
              "end as responsibility_full",
              "",
              "from ftdeepviewdb.facttable fa",
              "left join ftdeepviewdb.dt_demographics dt on dt.responsibility_abv = fa.responsibility"
            ]
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select  distinct",
              "case",
              "when  dt.responsibility_abv is null then isnull(fa.responsibility,'UNKN')",
              "when dt.responsibility_abv = '' then 'UNKN'",
              "else dt.responsibility_abv",
              "end as responsibility_abv",
              ",case",
              "when fa.responsibility ='' then 'Unknown'",
              "when fa.responsibility  is null then 'Unknown'",
              "when  dt.responsibility_abv is null then 'Unknown'  ",
              "",
              "else dt.responsibility_full",
              "end as responsibility_full",
              "",
              "from ftdeepviewdb.facttable fa",
              "left join ftdeepviewdb.dt_demographics dt on dt.responsibility_abv = fa.responsibility</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "demographic_seg_new",
        "isHidden": true,
        "columns": [
          {
            "name": "responsibility_abv",
            "dataType": "string",
            "sourceColumn": "responsibility_abv",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "responsibility",
            "dataType": "string",
            "sourceColumn": "responsibility",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "position_abv",
            "dataType": "string",
            "sourceColumn": "position_abv",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "position",
            "dataType": "string",
            "sourceColumn": "position",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "industry_abv",
            "dataType": "string",
            "sourceColumn": "industry_abv",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "industry",
            "dataType": "string",
            "sourceColumn": "industry",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "segmentid",
            "dataType": "string",
            "sourceColumn": "segmentid",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "demographic_seg_new",
            "dataView": "full",
            "source": {
              "query": "select responsibility_abv,responsibility,position_abv,position,industry_abv,industry,cast(segmentid as text) from ftdeepviewdb.dim_demographic_segments_new",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select responsibility_abv,responsibility,position_abv,position,industry_abv,industry,cast(segmentid as text) from ftdeepviewdb.dim_demographic_segments_new</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select responsibility_abv,responsibility,position_abv,position,industry_abv,industry,cast(segmentid as text) from ftdeepviewdb.dim_demographic_segments_new"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "demographic_seg_new"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select responsibility_abv,responsibility,position_abv,position,industry_abv,industry,cast(segmentid as text) from ftdeepviewdb.dim_demographic_segments_new</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "manytomany_new",
        "isHidden": true,
        "columns": [
          {
            "name": "demographic segments",
            "dataType": "string",
            "sourceColumn": "demographic segments",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "segmentid",
            "dataType": "string",
            "sourceColumn": "segmentid",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "manytomany_new",
            "dataView": "full",
            "source": {
              "query": "select \"demographic segments\", cast(segmentid as text) from ftdeepviewdb.dim_demographic_segments_new_manytomany",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select \"demographic segments\", cast(segmentid as text) from ftdeepviewdb.dim_demographic_segments_new_manytomany</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select \"demographic segments\", cast(segmentid as text) from ftdeepviewdb.dim_demographic_segments_new_manytomany"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "manytomany_new"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select \"demographic segments\", cast(segmentid as text) from ftdeepviewdb.dim_demographic_segments_new_manytomany</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "Segment_name_DT",
        "columns": [
          {
            "name": "segment_name",
            "dataType": "string",
            "sourceColumn": "segment_name",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "Segment_name",
            "dataView": "full",
            "source": {
              "query": "select distinct \"demographic segments\" as Segment_Name from ftdeepviewdb.dim_demographic_segments_new_manytomany",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select distinct \"demographic segments\" as Segment_Name from ftdeepviewdb.dim_demographic_segments_new_manytomany</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select distinct \"demographic segments\" as Segment_Name from ftdeepviewdb.dim_demographic_segments_new_manytomany"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Segment_name"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select distinct \"demographic segments\" as Segment_Name from ftdeepviewdb.dim_demographic_segments_new_manytomany</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "gender",
        "columns": [
          {
            "name": "gender",
            "dataType": "string",
            "sourceColumn": "gender",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "gender",
            "dataView": "full",
            "source": {
              "query": [
                "select 'M' as gender ",
                "union",
                "select 'F' ",
                "union ",
                "select 'Unknown'"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select 'M' as gender ",
                  "union",
                  "select 'F' ",
                  "union ",
                  "select 'Unknown'</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select 'M' as gender ",
              "union",
              "select 'F' ",
              "union ",
              "select 'Unknown'"
            ]
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "gender"
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select 'M' as gender ",
              "union",
              "select 'F' ",
              "union ",
              "select 'Unknown'</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "dim_krux",
        "isHidden": true,
        "columns": [
          {
            "name": "krux_key",
            "dataType": "int64",
            "sourceColumn": "krux_key",
            "sourceProviderType": "BigInt"
          },
          {
            "name": "krux",
            "dataType": "string",
            "sourceColumn": "krux",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "dim_krux",
            "dataView": "full",
            "source": {
              "query": [
                "SELECT krux_key, krux ",
                "\tFROM ftdeepviewdb.dim_krux"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT krux_key, krux ",
                  "\tFROM ftdeepviewdb.dim_krux</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "SELECT krux_key, krux ",
              "\tFROM ftdeepviewdb.dim_krux"
            ]
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_krux"
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT krux_key, krux ",
              "\tFROM ftdeepviewdb.dim_krux</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "many_to_many_krux",
        "isHidden": true,
        "columns": [
          {
            "name": "split_part",
            "dataType": "string",
            "sourceColumn": "split_part",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "krux_key",
            "dataType": "string",
            "sourceColumn": "krux_key"
          }
        ],
        "partitions": [
          {
            "name": "many_to_many_krux",
            "dataView": "full",
            "source": {
              "query": "SELECT split_part, krux_key\tFROM ftdeepviewdb.dim_krux_mtom_krux",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT split_part, krux_key\tFROM ftdeepviewdb.dim_krux_mtom_krux</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "SELECT split_part, krux_key\tFROM ftdeepviewdb.dim_krux_mtom_krux"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "many_to_many_krux"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT split_part, krux_key\tFROM ftdeepviewdb.dim_krux_mtom_krux</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "krux_segment_krux_only",
        "columns": [
          {
            "name": "segment_name",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "segment_name",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "segment",
            "dataType": "string",
            "sourceColumn": "segment",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "krux_segment_krux_only",
            "dataView": "full",
            "source": {
              "query": "select segment_name,segment_id || ' - (' || segment_name  || ')'  as Segment from ftdeepviewdb.krux_segment_name",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select segment_name,segment_id || ' - (' || segment_name  || ')'  as Segment from ftdeepviewdb.krux_segment_name</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select segment_name,segment_id || ' - (' || segment_name  || ')'  as Segment from ftdeepviewdb.krux_segment_name"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "krux_segment_krux_only"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select segment_name,segment_id || ' - (' || segment_name  || ')'  as Segment from ftdeepviewdb.krux_segment_name</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "buy_type",
        "columns": [
          {
            "name": "adcreative_key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "adcreative_key",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "buy_type",
            "dataType": "string",
            "sourceColumn": "buy_type",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "buy_type",
            "dataView": "full",
            "source": {
              "query": [
                "with cte as (SELECT *",
                "",
                "FROM ftdeepviewdb.dim_advertiser",
                "where advertiser_key not in (select advertiser_key from ftdeepviewdb.dim_advertiser_unpaid)",
                ")",
                "SELECT ",
                "isnull(creative_key || da.advertiser_key, cast(da.advertiser_key as varchar))  as adcreative_key,",
                "",
                "isnull(da.buy_type, 'UNKNOWN') as buy_type ",
                "FROM ftdeepviewdb.dim_advertiser da ",
                "left join ftdeepviewdb.dim_advertiser_unpaid du on du.advertiser_key = da.advertiser_key",
                "left join cte c on c.advertiser_key = da.advertiser_key",
                "left join ftdeepviewdb.dim_creative dcr on dcr.line_item_id  = da.line_item_id"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>with cte as (SELECT *",
                  "",
                  "FROM ftdeepviewdb.dim_advertiser",
                  "where advertiser_key not in (select advertiser_key from ftdeepviewdb.dim_advertiser_unpaid)",
                  ")",
                  "SELECT ",
                  "isnull(creative_key || da.advertiser_key, cast(da.advertiser_key as varchar))  as adcreative_key,",
                  "",
                  "isnull(da.buy_type, 'UNKNOWN') as buy_type ",
                  "FROM ftdeepviewdb.dim_advertiser da ",
                  "left join ftdeepviewdb.dim_advertiser_unpaid du on du.advertiser_key = da.advertiser_key",
                  "left join cte c on c.advertiser_key = da.advertiser_key",
                  "left join ftdeepviewdb.dim_creative dcr on dcr.line_item_id  = da.line_item_id</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "with cte as (SELECT *",
              "",
              "FROM ftdeepviewdb.dim_advertiser",
              "where advertiser_key not in (select advertiser_key from ftdeepviewdb.dim_advertiser_unpaid)",
              ")",
              "SELECT ",
              "isnull(creative_key || da.advertiser_key, cast(da.advertiser_key as varchar))  as adcreative_key,",
              "",
              "isnull(da.buy_type, 'UNKNOWN') as buy_type ",
              "FROM ftdeepviewdb.dim_advertiser da ",
              "left join ftdeepviewdb.dim_advertiser_unpaid du on du.advertiser_key = da.advertiser_key",
              "left join cte c on c.advertiser_key = da.advertiser_key",
              "left join ftdeepviewdb.dim_creative dcr on dcr.line_item_id  = da.line_item_id"
            ]
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "buy_type"
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>with cte as (SELECT *",
              "",
              "FROM ftdeepviewdb.dim_advertiser",
              "where advertiser_key not in (select advertiser_key from ftdeepviewdb.dim_advertiser_unpaid)",
              ")",
              "SELECT ",
              "isnull(creative_key || da.advertiser_key, cast(da.advertiser_key as varchar))  as adcreative_key,",
              "",
              "isnull(da.buy_type, 'UNKNOWN') as buy_type ",
              "FROM ftdeepviewdb.dim_advertiser da ",
              "left join ftdeepviewdb.dim_advertiser_unpaid du on du.advertiser_key = da.advertiser_key",
              "left join cte c on c.advertiser_key = da.advertiser_key",
              "left join ftdeepviewdb.dim_creative dcr on dcr.line_item_id  = da.line_item_id</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "admant_category",
        "isHidden": true,
        "columns": [
          {
            "name": "split_part",
            "dataType": "string",
            "sourceColumn": "split_part",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "category",
            "dataType": "string",
            "sourceColumn": "category"
          }
        ],
        "partitions": [
          {
            "name": "admant_category",
            "dataView": "full",
            "source": {
              "query": "select category,split_part from ftdeepviewdb.admantx_category",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select category,split_part from ftdeepviewdb.admantx_category</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select category,split_part from ftdeepviewdb.admantx_category"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "admant_category"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select category,split_part from ftdeepviewdb.admantx_category</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "admantx_admant",
        "isHidden": true,
        "columns": [
          {
            "name": "split_part",
            "dataType": "string",
            "sourceColumn": "split_part",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "admant",
            "dataType": "string",
            "sourceColumn": "admant"
          }
        ],
        "partitions": [
          {
            "name": "admantx_admant",
            "dataView": "full",
            "source": {
              "query": "select admant, split_part from ftdeepviewdb.admantx_admant",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select admant, split_part from ftdeepviewdb.admantx_admant</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select admant, split_part from ftdeepviewdb.admantx_admant"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "admantx_admant"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select admant, split_part from ftdeepviewdb.admantx_admant</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "dim_articles",
        "isHidden": true,
        "columns": [
          {
            "name": "title",
            "dataType": "string",
            "sourceColumn": "title",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "url",
            "dataType": "string",
            "sourceColumn": "url",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "auuid",
            "dataType": "string",
            "sourceColumn": "auuid"
          }
        ],
        "partitions": [
          {
            "name": "dim_articles",
            "dataView": "full",
            "source": {
              "query": [
                "select",
                "auuid",
                "",
                ",title",
                ",url",
                "from ftdeepviewdb.dim_articles"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select",
                  "auuid",
                  "",
                  ",title",
                  ",url",
                  "from ftdeepviewdb.dim_articles</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select",
              "auuid",
              "",
              ",title",
              ",url",
              "from ftdeepviewdb.dim_articles"
            ]
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_articles"
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select",
              "auuid",
              "",
              ",title",
              ",url",
              "from ftdeepviewdb.dim_articles</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "Dim_Admantx_Admant",
        "columns": [
          {
            "name": "split_part",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "split_part"
          },
          {
            "name": "description",
            "dataType": "string",
            "sourceColumn": "description"
          },
          {
            "name": "type",
            "dataType": "string",
            "sourceColumn": "type"
          }
        ],
        "partitions": [
          {
            "name": "Dim_Admantx_Admant",
            "dataView": "full",
            "source": {
              "query": [
                "select distinct split_part, split_part || ' - ' || isnull(description, 'Unknown') as description ,isnull(type, 'Unknown') as Type from ftdeepviewdb.admantx_admant aa",
                "left join  ftdeepviewdb.dim_admantx_admant da on da.code = aa.split_part",
                "where split_part is not null and split_part <>''"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select distinct split_part, split_part || ' - ' || isnull(description, 'Unknown') as description ,isnull(type, 'Unknown') as Type from ftdeepviewdb.admantx_admant aa",
                  "left join  ftdeepviewdb.dim_admantx_admant da on da.code = aa.split_part",
                  "where split_part is not null and split_part <>''</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select distinct split_part, split_part || ' - ' || isnull(description, 'Unknown') as description ,isnull(type, 'Unknown') as Type from ftdeepviewdb.admantx_admant aa",
              "left join  ftdeepviewdb.dim_admantx_admant da on da.code = aa.split_part",
              "where split_part is not null and split_part <>''"
            ]
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Dim_Admantx_Admant"
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select distinct split_part, split_part || ' - ' || isnull(description, 'Unknown') as description ,isnull(type, 'Unknown') as Type from ftdeepviewdb.admantx_admant aa",
              "left join  ftdeepviewdb.dim_admantx_admant da on da.code = aa.split_part",
              "where split_part is not null and split_part <>''</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "Dim_admantx_Categories",
        "columns": [
          {
            "name": "category",
            "dataType": "string",
            "sourceColumn": "category",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "Dim_admantx_Categories",
            "dataView": "full",
            "source": {
              "query": [
                "select ",
                "category",
                "from ftdeepviewdb.dim_admantics_category"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select ",
                  "category",
                  "from ftdeepviewdb.dim_admantics_category</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "select ",
              "category",
              "from ftdeepviewdb.dim_admantics_category"
            ]
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "Dim_admantx_Categories"
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select ",
              "category",
              "from ftdeepviewdb.dim_admantics_category</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "dim_category_reference",
        "isHidden": true,
        "columns": [
          {
            "name": "category",
            "dataType": "string",
            "sourceColumn": "category",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "dim_category_reference",
            "dataView": "full",
            "source": {
              "query": "select category from ftdeepviewdb.dim_category_reference",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select category from ftdeepviewdb.dim_category_reference</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select category from ftdeepviewdb.dim_category_reference"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_category_reference"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select category from ftdeepviewdb.dim_category_reference</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "dim_admant_reference",
        "isHidden": true,
        "columns": [
          {
            "name": "admant",
            "dataType": "string",
            "sourceColumn": "admant",
            "sourceProviderType": "VarChar"
          }
        ],
        "partitions": [
          {
            "name": "dim_admant_reference",
            "dataView": "full",
            "source": {
              "query": "select admant from ftdeepviewdb.dim_admant_reference",
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select admant from ftdeepviewdb.dim_admant_reference</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "select admant from ftdeepviewdb.dim_admant_reference"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "dim_admant_reference"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>select admant from ftdeepviewdb.dim_admant_reference</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "User_Demographics",
        "columns": [
          {
            "name": "gender",
            "dataType": "string",
            "sourceColumn": "gender",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "position",
            "dataType": "string",
            "sourceColumn": "position",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "responsibility",
            "dataType": "string",
            "sourceColumn": "responsibility",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "industry",
            "dataType": "string",
            "sourceColumn": "industry",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "investorgroup",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "investorgroup",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "companysize",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "companysize",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "companyturnover",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "companyturnover",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "demographic segments",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "demographic segments",
            "sourceProviderType": "VarChar"
          },
          {
            "name": "dim_user_demographics_key",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "dim_user_demographics_key",
            "sourceProviderType": "Integer"
          }
        ],
        "partitions": [
          {
            "name": "User_Demographics",
            "dataView": "full",
            "source": {
              "query": [
                "SELECT   ",
                "",
                "gender",
                ",position",
                ",responsibility",
                ",industry",
                ",investorgroup",
                ",companysize",
                ",companyturnover",
                ",case",
                "when position in ('OWNER/PARTNER/PROPRIETOR',",
                "'CEO/PRESIDENT/CHAIRMAN',",
                "'OTHER C LEVEL (CFO/COO/CIO/CMO)',",
                "'EXEC MGMT (EVP/SVP/MD)',",
                "'VP/DIRECTOR') then UPPER('C-Suite')",
                "when position in ('SENIOR MANAGER/DEPT HEAD',",
                "'PROFESSIONAL',",
                "'CONSULTANT',",
                "'MANAGER/SUPERVISOR',",
                "'ANALYST',",
                "'ASSOCIATE',",
                "'PROGRAMME/PROJECT MANAGER',",
                "'SECRETARY/TREASURER',",
                "'OTHER') then UPPER('Decision Makers')",
                "when position in ('INFORMATION TECHNOLOGY',",
                "'IT/COMPUTING',",
                "'IT/TECH/TELECOMS',",
                "'IT AND COMPUTING',",
                "'TECHNICAL/BUSINESS SPECIALIST') then UPPER('Technology Decision Makers')",
                "when industry in ('IT/TECH/TELECOMS','IT/COMPUTING')",
                "then UPPER('Technology Decision Makers')",
                "when responsibility in ('INFORMATION TECHNOLOGY','IT/COMPUTING')",
                "then UPPER('Technology Decision Makers')",
                "when position in ('BANKING AND INVESTMENT',",
                "'BROKER/TRADER',",
                "'ACCOUNTING/FINANCE',",
                "'INSURANCE',",
                "'MONEY/PORTFOLIO MANAGEMENT',",
                "'RISK MANAGEMENT/COMPLIANCE',",
                "'BROKER/TRADER/ADVISOR',",
                "'CONTROLLER/FINANCIAL OFF',",
                "'BANKING',",
                "'FINANCIAL SERVICES',",
                "'FUND/ASSET MANAGEMENT') then UPPER('Financial Professionals')",
                "when industry in ('BANKING','FINANCIAL SERVICES','FUND/ASSET MANAGEMENT')",
                "then UPPER('BANKING AND INVESTMENT')",
                "when responsibility in ('BROKER/TRADER','ACCOUNTING/FINANCE','INSURANCE','MONEY/PORTFOLIO MANAGEMENT','RISK MANAGEMENT/COMPLIANCE')",
                "then UPPER('BANKING AND INVESTMENT')",
                "when responsibility in ('IFA/FINANCIAL ADVISER') then UPPER('Financial Advisors')",
                "when position in ('DIPLOMAT/SEN GOVT OFFICER',",
                "'POLITICIAN/GOVERNMENT MINISTER',",
                "'GOV/PUBLIC SERVICE/NGO') then UPPER('Government/Lobbyists')",
                "when industry in ('GOVT/PUBLIC SERVICE/NGO') then UPPER('Government/Lobbyists')",
                "when position like '%L ORG OFFICIAL'",
                "then UPPER('Government/Lobbyists')",
                "else 'UNKNOWN'",
                "end as \"Demographic Segments\"",
                ",dim_user_demographics_key",
                "",
                "FROM [ftdeepviewdb].[dim_user_demographics]"
              ],
              "dataSource": "Custom 25"
            },
            "annotations": [
              {
                "name": "QueryEditorSerialization",
                "value": [
                  "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT   ",
                  "",
                  "gender",
                  ",position",
                  ",responsibility",
                  ",industry",
                  ",investorgroup",
                  ",companysize",
                  ",companyturnover",
                  ",case",
                  "when position in ('OWNER/PARTNER/PROPRIETOR',",
                  "'CEO/PRESIDENT/CHAIRMAN',",
                  "'OTHER C LEVEL (CFO/COO/CIO/CMO)',",
                  "'EXEC MGMT (EVP/SVP/MD)',",
                  "'VP/DIRECTOR') then UPPER('C-Suite')",
                  "when position in ('SENIOR MANAGER/DEPT HEAD',",
                  "'PROFESSIONAL',",
                  "'CONSULTANT',",
                  "'MANAGER/SUPERVISOR',",
                  "'ANALYST',",
                  "'ASSOCIATE',",
                  "'PROGRAMME/PROJECT MANAGER',",
                  "'SECRETARY/TREASURER',",
                  "'OTHER') then UPPER('Decision Makers')",
                  "when position in ('INFORMATION TECHNOLOGY',",
                  "'IT/COMPUTING',",
                  "'IT/TECH/TELECOMS',",
                  "'IT AND COMPUTING',",
                  "'TECHNICAL/BUSINESS SPECIALIST') then UPPER('Technology Decision Makers')",
                  "when industry in ('IT/TECH/TELECOMS','IT/COMPUTING')",
                  "then UPPER('Technology Decision Makers')",
                  "when responsibility in ('INFORMATION TECHNOLOGY','IT/COMPUTING')",
                  "then UPPER('Technology Decision Makers')",
                  "when position in ('BANKING AND INVESTMENT',",
                  "'BROKER/TRADER',",
                  "'ACCOUNTING/FINANCE',",
                  "'INSURANCE',",
                  "'MONEY/PORTFOLIO MANAGEMENT',",
                  "'RISK MANAGEMENT/COMPLIANCE',",
                  "'BROKER/TRADER/ADVISOR',",
                  "'CONTROLLER/FINANCIAL OFF',",
                  "'BANKING',",
                  "'FINANCIAL SERVICES',",
                  "'FUND/ASSET MANAGEMENT') then UPPER('Financial Professionals')",
                  "when industry in ('BANKING','FINANCIAL SERVICES','FUND/ASSET MANAGEMENT')",
                  "then UPPER('BANKING AND INVESTMENT')",
                  "when responsibility in ('BROKER/TRADER','ACCOUNTING/FINANCE','INSURANCE','MONEY/PORTFOLIO MANAGEMENT','RISK MANAGEMENT/COMPLIANCE')",
                  "then UPPER('BANKING AND INVESTMENT')",
                  "when responsibility in ('IFA/FINANCIAL ADVISER') then UPPER('Financial Advisors')",
                  "when position in ('DIPLOMAT/SEN GOVT OFFICER',",
                  "'POLITICIAN/GOVERNMENT MINISTER',",
                  "'GOV/PUBLIC SERVICE/NGO') then UPPER('Government/Lobbyists')",
                  "when industry in ('GOVT/PUBLIC SERVICE/NGO') then UPPER('Government/Lobbyists')",
                  "when position like '%L ORG OFFICIAL'",
                  "then UPPER('Government/Lobbyists')",
                  "else 'UNKNOWN'",
                  "end as \"Demographic Segments\"",
                  ",dim_user_demographics_key",
                  "",
                  "FROM [ftdeepviewdb].[dim_user_demographics]</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
                ]
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": [
              "SELECT   ",
              "",
              "gender",
              ",position",
              ",responsibility",
              ",industry",
              ",investorgroup",
              ",companysize",
              ",companyturnover",
              ",case",
              "when position in ('OWNER/PARTNER/PROPRIETOR',",
              "'CEO/PRESIDENT/CHAIRMAN',",
              "'OTHER C LEVEL (CFO/COO/CIO/CMO)',",
              "'EXEC MGMT (EVP/SVP/MD)',",
              "'VP/DIRECTOR') then UPPER('C-Suite')",
              "when position in ('SENIOR MANAGER/DEPT HEAD',",
              "'PROFESSIONAL',",
              "'CONSULTANT',",
              "'MANAGER/SUPERVISOR',",
              "'ANALYST',",
              "'ASSOCIATE',",
              "'PROGRAMME/PROJECT MANAGER',",
              "'SECRETARY/TREASURER',",
              "'OTHER') then UPPER('Decision Makers')",
              "when position in ('INFORMATION TECHNOLOGY',",
              "'IT/COMPUTING',",
              "'IT/TECH/TELECOMS',",
              "'IT AND COMPUTING',",
              "'TECHNICAL/BUSINESS SPECIALIST') then UPPER('Technology Decision Makers')",
              "when industry in ('IT/TECH/TELECOMS','IT/COMPUTING')",
              "then UPPER('Technology Decision Makers')",
              "when responsibility in ('INFORMATION TECHNOLOGY','IT/COMPUTING')",
              "then UPPER('Technology Decision Makers')",
              "when position in ('BANKING AND INVESTMENT',",
              "'BROKER/TRADER',",
              "'ACCOUNTING/FINANCE',",
              "'INSURANCE',",
              "'MONEY/PORTFOLIO MANAGEMENT',",
              "'RISK MANAGEMENT/COMPLIANCE',",
              "'BROKER/TRADER/ADVISOR',",
              "'CONTROLLER/FINANCIAL OFF',",
              "'BANKING',",
              "'FINANCIAL SERVICES',",
              "'FUND/ASSET MANAGEMENT') then UPPER('Financial Professionals')",
              "when industry in ('BANKING','FINANCIAL SERVICES','FUND/ASSET MANAGEMENT')",
              "then UPPER('BANKING AND INVESTMENT')",
              "when responsibility in ('BROKER/TRADER','ACCOUNTING/FINANCE','INSURANCE','MONEY/PORTFOLIO MANAGEMENT','RISK MANAGEMENT/COMPLIANCE')",
              "then UPPER('BANKING AND INVESTMENT')",
              "when responsibility in ('IFA/FINANCIAL ADVISER') then UPPER('Financial Advisors')",
              "when position in ('DIPLOMAT/SEN GOVT OFFICER',",
              "'POLITICIAN/GOVERNMENT MINISTER',",
              "'GOV/PUBLIC SERVICE/NGO') then UPPER('Government/Lobbyists')",
              "when industry in ('GOVT/PUBLIC SERVICE/NGO') then UPPER('Government/Lobbyists')",
              "when position like '%L ORG OFFICIAL'",
              "then UPPER('Government/Lobbyists')",
              "else 'UNKNOWN'",
              "end as \"Demographic Segments\"",
              ",dim_user_demographics_key",
              "",
              "FROM [ftdeepviewdb].[dim_user_demographics]"
            ]
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "User_Demographics"
          },
          {
            "name": "QueryEditorSerialization",
            "value": [
              "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT   ",
              "",
              "gender",
              ",position",
              ",responsibility",
              ",industry",
              ",investorgroup",
              ",companysize",
              ",companyturnover",
              ",case",
              "when position in ('OWNER/PARTNER/PROPRIETOR',",
              "'CEO/PRESIDENT/CHAIRMAN',",
              "'OTHER C LEVEL (CFO/COO/CIO/CMO)',",
              "'EXEC MGMT (EVP/SVP/MD)',",
              "'VP/DIRECTOR') then UPPER('C-Suite')",
              "when position in ('SENIOR MANAGER/DEPT HEAD',",
              "'PROFESSIONAL',",
              "'CONSULTANT',",
              "'MANAGER/SUPERVISOR',",
              "'ANALYST',",
              "'ASSOCIATE',",
              "'PROGRAMME/PROJECT MANAGER',",
              "'SECRETARY/TREASURER',",
              "'OTHER') then UPPER('Decision Makers')",
              "when position in ('INFORMATION TECHNOLOGY',",
              "'IT/COMPUTING',",
              "'IT/TECH/TELECOMS',",
              "'IT AND COMPUTING',",
              "'TECHNICAL/BUSINESS SPECIALIST') then UPPER('Technology Decision Makers')",
              "when industry in ('IT/TECH/TELECOMS','IT/COMPUTING')",
              "then UPPER('Technology Decision Makers')",
              "when responsibility in ('INFORMATION TECHNOLOGY','IT/COMPUTING')",
              "then UPPER('Technology Decision Makers')",
              "when position in ('BANKING AND INVESTMENT',",
              "'BROKER/TRADER',",
              "'ACCOUNTING/FINANCE',",
              "'INSURANCE',",
              "'MONEY/PORTFOLIO MANAGEMENT',",
              "'RISK MANAGEMENT/COMPLIANCE',",
              "'BROKER/TRADER/ADVISOR',",
              "'CONTROLLER/FINANCIAL OFF',",
              "'BANKING',",
              "'FINANCIAL SERVICES',",
              "'FUND/ASSET MANAGEMENT') then UPPER('Financial Professionals')",
              "when industry in ('BANKING','FINANCIAL SERVICES','FUND/ASSET MANAGEMENT')",
              "then UPPER('BANKING AND INVESTMENT')",
              "when responsibility in ('BROKER/TRADER','ACCOUNTING/FINANCE','INSURANCE','MONEY/PORTFOLIO MANAGEMENT','RISK MANAGEMENT/COMPLIANCE')",
              "then UPPER('BANKING AND INVESTMENT')",
              "when responsibility in ('IFA/FINANCIAL ADVISER') then UPPER('Financial Advisors')",
              "when position in ('DIPLOMAT/SEN GOVT OFFICER',",
              "'POLITICIAN/GOVERNMENT MINISTER',",
              "'GOV/PUBLIC SERVICE/NGO') then UPPER('Government/Lobbyists')",
              "when industry in ('GOVT/PUBLIC SERVICE/NGO') then UPPER('Government/Lobbyists')",
              "when position like '%L ORG OFFICIAL'",
              "then UPPER('Government/Lobbyists')",
              "else 'UNKNOWN'",
              "end as \"Demographic Segments\"",
              ",dim_user_demographics_key",
              "",
              "FROM [ftdeepviewdb].[dim_user_demographics]</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
            ]
          }
        ]
      },
      {
        "name": "campaigns",
        "isHidden": true,
        "columns": [
          {
            "type": "calculatedTableColumn",
            "name": "campaign name paid",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "Advertisers[campaign name paid]"
          }
        ],
        "partitions": [
          {
            "name": "CalculatedTable 1",
            "source": {
              "type": "calculated",
              "expression": "SUMMARIZECOLUMNS(Advertisers[campaign name paid],FILTER(Advertisers,Advertisers[enddate] > now()))"
            }
          }
        ]
      }
    ],
    "relationships": [
      {
        "name": "1699b81d-e5ce-4f66-8853-18d8364772e1",
        "fromTable": "Metrics",
        "fromColumn": "category_key",
        "toTable": "Categories",
        "toColumn": "category_key"
      },
      {
        "name": "814afc1f-30b0-45b5-8f61-78db0f60143c",
        "fromTable": "Metrics",
        "fromColumn": "country_key",
        "toTable": "Region",
        "toColumn": "dim_event_country_key"
      },
      {
        "name": "49a3b5b4-6c88-438b-8d5e-433c11276a97",
        "fromTable": "Metrics",
        "fromColumn": "time_key",
        "toTable": "Time_of_Day",
        "toColumn": "dim_time_key"
      },
      {
        "name": "9f59babd-8dba-4110-aa3d-e95f8acd2bae",
        "fromTable": "Metrics",
        "fromColumn": "imp_demos_key",
        "toTable": "Event_Demographics",
        "toColumn": "dim_event_demographics_key"
      },
      {
        "name": "233edad9-6b04-49d8-aa6a-ea2cad0162ba",
        "fromTable": "Metrics",
        "fromColumn": "ad_unit_key",
        "toTable": "AdUnit",
        "toColumn": "ad_unit_id"
      },
      {
        "name": "6beedddd-558b-44fb-85ca-cb1f83ee072e",
        "fromTable": "Metrics",
        "fromColumn": "ad_position",
        "toTable": "Ad_Position",
        "toColumn": "ad_position"
      },
      {
        "name": "e7bf9fed-3765-4f87-b0ae-695cbcc20409",
        "fromTable": "Metrics",
        "fromColumn": "adcreative_key",
        "toTable": "Advertisers",
        "toColumn": "adcreative_key"
      },
      {
        "name": "6511e774-113a-40df-a8dc-b6c5bcab467a",
        "fromTable": "Metrics",
        "fromColumn": "tablekey",
        "toTable": "DailyCounts",
        "toColumn": "tablekey"
      },
      {
        "name": "f7ac5be5-31f9-44a5-9c76-6c1c9d08a33e",
        "fromTable": "Metrics",
        "fromColumn": "creative_size",
        "toTable": "Creatives",
        "toColumn": "creative_size"
      },
      {
        "name": "c54a7daa-3e77-4ddb-9aec-0ec3e593b5c9",
        "fromTable": "Metrics",
        "fromColumn": "pt",
        "toTable": "Page_Type",
        "toColumn": "page_type"
      },
      {
        "name": "b467bda5-9037-43e3-86d7-0f2a716f366e",
        "fromTable": "Metrics",
        "fromColumn": "res",
        "toTable": "Res",
        "toColumn": "res"
      },
      {
        "name": "97937269-2b2c-48d8-a984-b71d23d111d8",
        "fromTable": "Metrics",
        "fromColumn": "slv",
        "toTable": "SLV",
        "toColumn": "slv"
      },
      {
        "name": "1591a9c2-6ba1-4c9c-825c-1c225ab779aa",
        "fromTable": "Metrics",
        "fromColumn": "industry",
        "toTable": "DT_Industry",
        "toColumn": "industry_abv"
      },
      {
        "name": "68728307-b468-4ed4-83aa-970583be7a01",
        "fromTable": "Metrics",
        "fromColumn": "position",
        "toTable": "DT_position",
        "toColumn": "position_abv"
      },
      {
        "name": "d8b59a1a-60b2-45c1-8b8e-68ac621e023a",
        "fromTable": "Metrics",
        "fromColumn": "responsibility",
        "toTable": "DT_responsibility",
        "toColumn": "responsibility_abv"
      },
      {
        "name": "e542a364-86c4-4678-8b1c-fd5fd8908a47",
        "fromTable": "Metrics",
        "fromColumn": "segmentid",
        "toTable": "demographic_seg_new",
        "toColumn": "segmentid"
      },
      {
        "name": "7f660c73-c990-480d-bd20-30e119c356f0",
        "fromTable": "manytomany_new",
        "fromColumn": "segmentid",
        "toTable": "demographic_seg_new",
        "toColumn": "segmentid",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "f403567b-6e09-434c-b47d-0bdda5541ac8",
        "fromTable": "manytomany_new",
        "fromColumn": "demographic segments",
        "toTable": "Segment_name_DT",
        "toColumn": "segment_name"
      },
      {
        "name": "555e94af-5c4b-4ee3-a520-60f5bcda8124",
        "fromTable": "Metrics",
        "fromColumn": "gender",
        "toTable": "gender",
        "toColumn": "gender"
      },
      {
        "name": "aa2be122-3c91-40c6-9fb2-3790a09b17e9",
        "fromTable": "Metrics",
        "fromColumn": "date_key",
        "toTable": "Dates",
        "toColumn": "datekey"
      },
      {
        "name": "b718a324-fb75-4632-92d7-60c1c904352c",
        "fromTable": "many_to_many_krux",
        "fromColumn": "split_part",
        "toTable": "krux_segment_krux_only",
        "toColumn": "segment_name"
      },
      {
        "name": "f24ed6dc-0e4a-4f8d-a8b5-ae83618b679e",
        "fromTable": "many_to_many_krux",
        "fromColumn": "krux_key",
        "toTable": "dim_krux",
        "toColumn": "krux_key",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "f25b9191-48e3-47a3-b5fb-239ec96bde21",
        "fromTable": "Metrics",
        "fromColumn": "krux_key",
        "toTable": "dim_krux",
        "toColumn": "krux_key"
      },
      {
        "name": "e68d670c-aba5-4bf8-95f9-43c58a13c8fb",
        "fromTable": "Metrics",
        "fromColumn": "adcreative_key",
        "toTable": "buy_type",
        "toColumn": "adcreative_key"
      },
      {
        "name": "a9ce3364-4caf-4d10-b9bf-f8a5b5a0d9d5",
        "fromTable": "admant_category",
        "fromColumn": "split_part",
        "toTable": "Dim_admantx_Categories",
        "toColumn": "category"
      },
      {
        "name": "c9ecc189-d31b-446b-b8b0-467e3ca5054f",
        "fromTable": "Metrics",
        "fromColumn": "auuid",
        "toTable": "dim_articles",
        "toColumn": "auuid"
      },
      {
        "name": "58dfe5c2-87d9-4882-a710-0133b85eabaa",
        "fromTable": "admant_category",
        "fromColumn": "category",
        "toTable": "dim_category_reference",
        "toColumn": "category",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "85c8d652-912e-4fae-afc7-01e1ab3fbc93",
        "fromTable": "admantx_admant",
        "fromColumn": "admant",
        "toTable": "dim_admant_reference",
        "toColumn": "admant",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "0af1c433-a33b-442d-93ec-7fc088c441b6",
        "fromTable": "Metrics",
        "fromColumn": "category",
        "toTable": "dim_category_reference",
        "toColumn": "category"
      },
      {
        "name": "a2a0f79a-f39f-42d1-91a4-669817b3500f",
        "fromTable": "Metrics",
        "fromColumn": "admant",
        "toTable": "dim_admant_reference",
        "toColumn": "admant"
      },
      {
        "name": "87b005fd-40b8-4f8c-b3ca-9fbfdae09bee",
        "fromTable": "admantx_admant",
        "fromColumn": "split_part",
        "toTable": "Dim_Admantx_Admant",
        "toColumn": "split_part"
      },
      {
        "name": "1f60c9e5-5b86-423c-a98c-b50a58927818",
        "fromTable": "Metrics",
        "fromColumn": "user_demos_key",
        "toTable": "User_Demographics",
        "toColumn": "dim_user_demographics_key"
      },
      {
        "name": "ee9d3fa3-6f1f-4ecb-b871-74e410cc35a1",
        "fromTable": "Metrics",
        "fromColumn": "clicks_users",
        "toTable": "Users Clicks",
        "toColumn": "id"
      },
      {
        "name": "9607c424-63ec-4618-b2aa-590ad19538cd",
        "fromTable": "Metrics",
        "fromColumn": "impressions_users",
        "toTable": "Users_Impressions",
        "toColumn": "id"
      },
      {
        "name": "5809f812-7a7d-4898-ba89-1ac729865f9b",
        "fromTable": "Advertisers",
        "fromColumn": "campaign name paid",
        "toTable": "campaigns",
        "toColumn": "campaign name paid"
      }
    ],
    "perspectives": [
      {
        "name": "Standard",
        "tables": [
          {
            "name": "Ad_Position",
            "columns": [
              {
                "name": "ad_position"
              }
            ]
          },
          {
            "name": "admant_category",
            "columns": [
              {
                "name": "category"
              },
              {
                "name": "split_part"
              }
            ]
          },
          {
            "name": "admantx_admant",
            "columns": [
              {
                "name": "admant"
              },
              {
                "name": "split_part"
              }
            ]
          },
          {
            "name": "AdUnit",
            "columns": [
              {
                "name": "ad_unit_id"
              },
              {
                "name": "childname"
              },
              {
                "name": "false level"
              },
              {
                "name": "grandparentname"
              },
              {
                "name": "greatgrandparentname"
              },
              {
                "name": "greatgreatgrandparentname"
              },
              {
                "name": "parentname"
              }
            ],
            "hierarchies": [
              {
                "name": "Ad Units"
              }
            ]
          },
          {
            "name": "Advertisers",
            "columns": [
              {
                "name": "adcreative_key"
              },
              {
                "name": "advertiser name paid"
              },
              {
                "name": "advertiser name unpaid"
              },
              {
                "name": "advertiser_key"
              },
              {
                "name": "agency_commission"
              },
              {
                "name": "buy_type"
              },
              {
                "name": "campaign name paid"
              },
              {
                "name": "campaign name unpaid"
              },
              {
                "name": "cost_model"
              },
              {
                "name": "Cost_Model2"
              },
              {
                "name": "creative_id_name"
              },
              {
                "name": "creative_key"
              },
              {
                "name": "creative_name"
              },
              {
                "name": "currency_code"
              },
              {
                "name": "duration"
              },
              {
                "name": "enddate"
              },
              {
                "name": "exchange_rate"
              },
              {
                "name": "gross_rate_gbp"
              },
              {
                "name": "gross_rate_local"
              },
              {
                "name": "gross_value_gbp"
              },
              {
                "name": "gross_value_local"
              },
              {
                "name": "line item name paid"
              },
              {
                "name": "line item name unpaid"
              },
              {
                "name": "line_item_name"
              },
              {
                "name": "live"
              },
              {
                "name": "measured_by_time"
              },
              {
                "name": "net_rate_gbp"
              },
              {
                "name": "net_value_gbp"
              },
              {
                "name": "netrate"
              },
              {
                "name": "netvalue"
              },
              {
                "name": "netvalueduration"
              },
              {
                "name": "roadblock_type"
              },
              {
                "name": "startdate"
              },
              {
                "name": "startdatekey"
              },
              {
                "name": "wrap_type"
              }
            ],
            "hierarchies": [
              {
                "name": "Advertisers Paid"
              },
              {
                "name": "Advertisers Unpaid"
              },
              {
                "name": "Cost Model"
              },
              {
                "name": "Wraps"
              }
            ]
          },
          {
            "name": "buy_type",
            "columns": [
              {
                "name": "adcreative_key"
              },
              {
                "name": "buy_type"
              }
            ]
          },
          {
            "name": "campaigns",
            "columns": [
              {
                "name": "campaign name paid"
              }
            ]
          },
          {
            "name": "Categories",
            "columns": [
              {
                "name": "category_code"
              },
              {
                "name": "category_key"
              },
              {
                "name": "parent_category"
              },
              {
                "name": "sub_category"
              }
            ],
            "hierarchies": [
              {
                "name": "Ad Categories"
              }
            ]
          },
          {
            "name": "Creatives",
            "columns": [
              {
                "name": "creative_size"
              }
            ]
          },
          {
            "name": "DailyCounts",
            "columns": [
              {
                "name": "advertiser_key"
              },
              {
                "name": "calc1"
              },
              {
                "name": "costmodel"
              },
              {
                "name": "creative_key"
              },
              {
                "name": "dailyrevenue"
              },
              {
                "name": "date_key"
              },
              {
                "name": "duration"
              },
              {
                "name": "maxrowcount"
              },
              {
                "name": "netrate"
              },
              {
                "name": "netvalue"
              },
              {
                "name": "rowcount"
              },
              {
                "name": "tablekey"
              }
            ]
          },
          {
            "name": "Dates",
            "columns": [
              {
                "name": "calendarmonth"
              },
              {
                "name": "calendarmonthofyear"
              },
              {
                "name": "calendarmonthofyearshort"
              },
              {
                "name": "calendaryear"
              },
              {
                "name": "calendaryearmonth"
              },
              {
                "name": "datekey"
              },
              {
                "name": "datenameeu"
              },
              {
                "name": "dayofmonth"
              },
              {
                "name": "dayofweek"
              },
              {
                "name": "dayofweekkey"
              },
              {
                "name": "dayofweekshort"
              },
              {
                "name": "fiscalweekofyear"
              },
              {
                "name": "fulldate"
              },
              {
                "name": "fulldatename"
              },
              {
                "name": "monthofyear"
              },
              {
                "name": "relativeweekskey"
              },
              {
                "name": "relativeyearskey"
              },
              {
                "name": "week"
              },
              {
                "name": "weekcommencing"
              },
              {
                "name": "weekenddate"
              },
              {
                "name": "weekending"
              },
              {
                "name": "weekofyear"
              },
              {
                "name": "weekstartdate"
              },
              {
                "name": "year"
              }
            ],
            "hierarchies": [
              {
                "name": "Business Calendar"
              },
              {
                "name": "Day of Week"
              },
              {
                "name": "Fiscal Week"
              },
              {
                "name": "Standard Calendar"
              }
            ]
          },
          {
            "name": "demographic_seg_new",
            "columns": [
              {
                "name": "industry"
              },
              {
                "name": "industry_abv"
              },
              {
                "name": "position"
              },
              {
                "name": "position_abv"
              },
              {
                "name": "responsibility"
              },
              {
                "name": "responsibility_abv"
              },
              {
                "name": "segmentid"
              }
            ]
          },
          {
            "name": "dim_admant_reference",
            "columns": [
              {
                "name": "admant"
              }
            ]
          },
          {
            "name": "Dim_Admantx_Admant",
            "columns": [
              {
                "name": "description"
              },
              {
                "name": "split_part"
              },
              {
                "name": "type"
              }
            ]
          },
          {
            "name": "Dim_admantx_Categories",
            "columns": [
              {
                "name": "category"
              }
            ]
          },
          {
            "name": "dim_articles",
            "columns": [
              {
                "name": "auuid"
              },
              {
                "name": "title"
              },
              {
                "name": "url"
              }
            ]
          },
          {
            "name": "dim_category_reference",
            "columns": [
              {
                "name": "category"
              }
            ]
          },
          {
            "name": "dim_krux",
            "columns": [
              {
                "name": "krux"
              },
              {
                "name": "krux_key"
              }
            ]
          },
          {
            "name": "DT_Industry",
            "columns": [
              {
                "name": "industry_abv"
              },
              {
                "name": "industry_full"
              }
            ]
          },
          {
            "name": "DT_position",
            "columns": [
              {
                "name": "position_abv"
              },
              {
                "name": "position_full"
              }
            ]
          },
          {
            "name": "DT_responsibility",
            "columns": [
              {
                "name": "responsibility_abv"
              },
              {
                "name": "responsibility_full"
              }
            ]
          },
          {
            "name": "Event_Demographics",
            "columns": [
              {
                "name": "ad_position"
              },
              {
                "name": "browser"
              },
              {
                "name": "creative_size"
              },
              {
                "name": "dim_event_demographics_key"
              },
              {
                "name": "internetconnection"
              },
              {
                "name": "os"
              }
            ]
          },
          {
            "name": "gender",
            "columns": [
              {
                "name": "gender"
              }
            ]
          },
          {
            "name": "krux_segment_krux_only",
            "columns": [
              {
                "name": "segment"
              },
              {
                "name": "segment_name"
              }
            ]
          },
          {
            "name": "many_to_many_krux",
            "columns": [
              {
                "name": "krux_key"
              },
              {
                "name": "split_part"
              }
            ]
          },
          {
            "name": "manytomany_new",
            "columns": [
              {
                "name": "demographic segments"
              },
              {
                "name": "segmentid"
              }
            ]
          },
          {
            "name": "Metrics",
            "columns": [
              {
                "name": "activeinviewtime"
              },
              {
                "name": "activeinviewtime_average"
              },
              {
                "name": "activepagedwell_content"
              },
              {
                "name": "activeview_eligibleimpression"
              },
              {
                "name": "ad_position"
              },
              {
                "name": "ad_unit_key"
              },
              {
                "name": "adcreative_key"
              },
              {
                "name": "admant"
              },
              {
                "name": "advertiser_key"
              },
              {
                "name": "automated_browser_rate"
              },
              {
                "name": "auuid"
              },
              {
                "name": "belowfoldad"
              },
              {
                "name": "belowfoldad_count"
              },
              {
                "name": "category"
              },
              {
                "name": "category_key"
              },
              {
                "name": "Clicks"
              },
              {
                "name": "clicks_users"
              },
              {
                "name": "costperunit"
              },
              {
                "name": "country_key"
              },
              {
                "name": "creative_key"
              },
              {
                "name": "creative_size"
              },
              {
                "name": "date_key"
              },
              {
                "name": "dfp_click_erights_id"
              },
              {
                "name": "dfp_click_user_id"
              },
              {
                "name": "dfp_impression_erights_id"
              },
              {
                "name": "dfp_impression_user_id"
              },
              {
                "name": "event_key"
              },
              {
                "name": "gender"
              },
              {
                "name": "guid"
              },
              {
                "name": "imp_demos_key"
              },
              {
                "name": "Impressions"
              },
              {
                "name": "impressions_users"
              },
              {
                "name": "incongruous_browser_rate"
              },
              {
                "name": "industry"
              },
              {
                "name": "inview_false"
              },
              {
                "name": "inview_true_percent"
              },
              {
                "name": "isknownspider_rate"
              },
              {
                "name": "krux_key"
              },
              {
                "name": "measurable_impression"
              },
              {
                "name": "netcpm"
              },
              {
                "name": "nht_totalimpressions"
              },
              {
                "name": "nhtmeasurableimpressions"
              },
              {
                "name": "position"
              },
              {
                "name": "pt"
              },
              {
                "name": "res"
              },
              {
                "name": "responsibility"
              },
              {
                "name": "revenuecalc"
              },
              {
                "name": "scroll"
              },
              {
                "name": "scroll_count"
              },
              {
                "name": "segmentid"
              },
              {
                "name": "slv"
              },
              {
                "name": "tablekey"
              },
              {
                "name": "time_key"
              },
              {
                "name": "timeuntilinview"
              },
              {
                "name": "totalimpressionsunfiltered"
              },
              {
                "name": "totalinteractions"
              },
              {
                "name": "totalinview_time"
              },
              {
                "name": "totalinviewimpressions"
              },
              {
                "name": "totalinviewtime_average"
              },
              {
                "name": "totalmeasurableimpressions"
              },
              {
                "name": "user_demos_key"
              },
              {
                "name": "user_id"
              },
              {
                "name": "value"
              },
              {
                "name": "viewable_impression"
              }
            ],
            "measures": [
              {
                "name": "All unique users"
              },
              {
                "name": "Combined_Revenue"
              },
              {
                "name": "countofimpressions"
              },
              {
                "name": "CTR"
              },
              {
                "name": "CumulativeImpressions"
              },
              {
                "name": "datecalc"
              },
              {
                "name": "daterange"
              },
              {
                "name": "Distinct Count Clicks DFP Users"
              },
              {
                "name": "Distinct Count Clicks Erights Users"
              },
              {
                "name": "e_CPM"
              },
              {
                "name": "eCPM"
              },
              {
                "name": "Known unique users"
              },
              {
                "name": "Measurable Impressions1"
              },
              {
                "name": "MeasurableImpressions"
              },
              {
                "name": "net_value"
              },
              {
                "name": "Revenue"
              },
              {
                "name": "Sell Through"
              },
              {
                "name": "SponsorshipRollup2"
              },
              {
                "name": "SPRrevenue"
              },
              {
                "name": "Sum of Distinct Clicks"
              },
              {
                "name": "sumxsponsorshiptotal"
              },
              {
                "name": "Total  Impressions"
              },
              {
                "name": "Total Clicks"
              },
              {
                "name": "Total clicks known users"
              },
              {
                "name": "Total clicks unknown users"
              },
              {
                "name": "Total impressions known users"
              },
              {
                "name": "Total impressions unknown users"
              },
              {
                "name": "Total_Revenue"
              },
              {
                "name": "Total_Revenue1"
              },
              {
                "name": "totalecpm"
              },
              {
                "name": "Unknown unique users"
              }
            ]
          },
          {
            "name": "Page_Type",
            "columns": [
              {
                "name": "page_type"
              }
            ]
          },
          {
            "name": "Region",
            "columns": [
              {
                "name": "city"
              },
              {
                "name": "continent"
              },
              {
                "name": "country"
              },
              {
                "name": "dim_event_country_key"
              },
              {
                "name": "region"
              },
              {
                "name": "trade_region"
              }
            ],
            "hierarchies": [
              {
                "name": "Regions"
              },
              {
                "name": "Trade Areas"
              }
            ]
          },
          {
            "name": "Res",
            "columns": [
              {
                "name": "res"
              }
            ]
          },
          {
            "name": "Segment_name_DT",
            "columns": [
              {
                "name": "segment_name"
              }
            ]
          },
          {
            "name": "SLV",
            "columns": [
              {
                "name": "slv"
              }
            ]
          },
          {
            "name": "Time_of_Day",
            "columns": [
              {
                "name": "daycategory"
              },
              {
                "name": "dim_time_key"
              },
              {
                "name": "hour"
              }
            ]
          },
          {
            "name": "User_Demographics",
            "columns": [
              {
                "name": "companysize"
              },
              {
                "name": "companyturnover"
              },
              {
                "name": "demographic segments"
              },
              {
                "name": "dim_user_demographics_key"
              },
              {
                "name": "gender"
              },
              {
                "name": "industry"
              },
              {
                "name": "investorgroup"
              },
              {
                "name": "position"
              },
              {
                "name": "responsibility"
              }
            ]
          },
          {
            "name": "Users Clicks",
            "columns": [
              {
                "name": "id"
              },
              {
                "name": "userstatus"
              }
            ]
          },
          {
            "name": "Users_Impressions",
            "columns": [
              {
                "name": "id"
              },
              {
                "name": "userstatus"
              }
            ]
          }
        ]
      },
      {
        "name": "Moat",
        "tables": [
          {
            "name": "Ad_Position",
            "columns": [
              {
                "name": "ad_position"
              }
            ]
          },
          {
            "name": "admant_category",
            "columns": [
              {
                "name": "category"
              },
              {
                "name": "split_part"
              }
            ]
          },
          {
            "name": "admantx_admant",
            "columns": [
              {
                "name": "admant"
              },
              {
                "name": "split_part"
              }
            ]
          },
          {
            "name": "AdUnit",
            "columns": [
              {
                "name": "ad_unit_id"
              },
              {
                "name": "childname"
              },
              {
                "name": "false level"
              },
              {
                "name": "grandparentname"
              },
              {
                "name": "greatgrandparentname"
              },
              {
                "name": "greatgreatgrandparentname"
              },
              {
                "name": "parentname"
              }
            ],
            "hierarchies": [
              {
                "name": "Ad Units"
              }
            ]
          },
          {
            "name": "Advertisers",
            "columns": [
              {
                "name": "adcreative_key"
              },
              {
                "name": "advertiser name paid"
              },
              {
                "name": "advertiser name unpaid"
              },
              {
                "name": "advertiser_key"
              },
              {
                "name": "agency_commission"
              },
              {
                "name": "buy_type"
              },
              {
                "name": "campaign name paid"
              },
              {
                "name": "campaign name unpaid"
              },
              {
                "name": "cost_model"
              },
              {
                "name": "Cost_Model2"
              },
              {
                "name": "creative_id_name"
              },
              {
                "name": "creative_key"
              },
              {
                "name": "creative_name"
              },
              {
                "name": "currency_code"
              },
              {
                "name": "duration"
              },
              {
                "name": "enddate"
              },
              {
                "name": "exchange_rate"
              },
              {
                "name": "gross_rate_gbp"
              },
              {
                "name": "gross_rate_local"
              },
              {
                "name": "gross_value_gbp"
              },
              {
                "name": "gross_value_local"
              },
              {
                "name": "line item name paid"
              },
              {
                "name": "line item name unpaid"
              },
              {
                "name": "line_item_name"
              },
              {
                "name": "live"
              },
              {
                "name": "measured_by_time"
              },
              {
                "name": "net_rate_gbp"
              },
              {
                "name": "net_value_gbp"
              },
              {
                "name": "netrate"
              },
              {
                "name": "netvalue"
              },
              {
                "name": "netvalueduration"
              },
              {
                "name": "roadblock_type"
              },
              {
                "name": "startdate"
              },
              {
                "name": "startdatekey"
              },
              {
                "name": "wrap_type"
              }
            ],
            "hierarchies": [
              {
                "name": "Advertisers Paid"
              },
              {
                "name": "Advertisers Unpaid"
              },
              {
                "name": "Cost Model"
              },
              {
                "name": "Wraps"
              }
            ]
          },
          {
            "name": "buy_type",
            "columns": [
              {
                "name": "adcreative_key"
              },
              {
                "name": "buy_type"
              }
            ]
          },
          {
            "name": "campaigns",
            "columns": [
              {
                "name": "campaign name paid"
              }
            ]
          },
          {
            "name": "Categories",
            "columns": [
              {
                "name": "category_code"
              },
              {
                "name": "category_key"
              },
              {
                "name": "parent_category"
              },
              {
                "name": "sub_category"
              }
            ],
            "hierarchies": [
              {
                "name": "Ad Categories"
              }
            ]
          },
          {
            "name": "Creatives",
            "columns": [
              {
                "name": "creative_size"
              }
            ]
          },
          {
            "name": "DailyCounts",
            "columns": [
              {
                "name": "advertiser_key"
              },
              {
                "name": "calc1"
              },
              {
                "name": "costmodel"
              },
              {
                "name": "creative_key"
              },
              {
                "name": "dailyrevenue"
              },
              {
                "name": "date_key"
              },
              {
                "name": "duration"
              },
              {
                "name": "maxrowcount"
              },
              {
                "name": "netrate"
              },
              {
                "name": "netvalue"
              },
              {
                "name": "rowcount"
              },
              {
                "name": "tablekey"
              }
            ]
          },
          {
            "name": "Dates",
            "columns": [
              {
                "name": "calendarmonth"
              },
              {
                "name": "calendarmonthofyear"
              },
              {
                "name": "calendarmonthofyearshort"
              },
              {
                "name": "calendaryear"
              },
              {
                "name": "calendaryearmonth"
              },
              {
                "name": "datekey"
              },
              {
                "name": "datenameeu"
              },
              {
                "name": "dayofmonth"
              },
              {
                "name": "dayofweek"
              },
              {
                "name": "dayofweekkey"
              },
              {
                "name": "dayofweekshort"
              },
              {
                "name": "fiscalweekofyear"
              },
              {
                "name": "fulldate"
              },
              {
                "name": "fulldatename"
              },
              {
                "name": "monthofyear"
              },
              {
                "name": "relativeweekskey"
              },
              {
                "name": "relativeyearskey"
              },
              {
                "name": "week"
              },
              {
                "name": "weekcommencing"
              },
              {
                "name": "weekenddate"
              },
              {
                "name": "weekending"
              },
              {
                "name": "weekofyear"
              },
              {
                "name": "weekstartdate"
              },
              {
                "name": "year"
              }
            ],
            "hierarchies": [
              {
                "name": "Business Calendar"
              },
              {
                "name": "Day of Week"
              },
              {
                "name": "Fiscal Week"
              },
              {
                "name": "Standard Calendar"
              }
            ]
          },
          {
            "name": "demographic_seg_new",
            "columns": [
              {
                "name": "industry"
              },
              {
                "name": "industry_abv"
              },
              {
                "name": "position"
              },
              {
                "name": "position_abv"
              },
              {
                "name": "responsibility"
              },
              {
                "name": "responsibility_abv"
              },
              {
                "name": "segmentid"
              }
            ]
          },
          {
            "name": "dim_admant_reference",
            "columns": [
              {
                "name": "admant"
              }
            ]
          },
          {
            "name": "Dim_Admantx_Admant",
            "columns": [
              {
                "name": "description"
              },
              {
                "name": "split_part"
              },
              {
                "name": "type"
              }
            ]
          },
          {
            "name": "Dim_admantx_Categories",
            "columns": [
              {
                "name": "category"
              }
            ]
          },
          {
            "name": "dim_articles",
            "columns": [
              {
                "name": "auuid"
              },
              {
                "name": "title"
              },
              {
                "name": "url"
              }
            ]
          },
          {
            "name": "dim_category_reference",
            "columns": [
              {
                "name": "category"
              }
            ]
          },
          {
            "name": "dim_krux",
            "columns": [
              {
                "name": "krux"
              },
              {
                "name": "krux_key"
              }
            ]
          },
          {
            "name": "DT_Industry",
            "columns": [
              {
                "name": "industry_abv"
              },
              {
                "name": "industry_full"
              }
            ]
          },
          {
            "name": "DT_position",
            "columns": [
              {
                "name": "position_abv"
              },
              {
                "name": "position_full"
              }
            ]
          },
          {
            "name": "DT_responsibility",
            "columns": [
              {
                "name": "responsibility_abv"
              },
              {
                "name": "responsibility_full"
              }
            ]
          },
          {
            "name": "Event_Demographics",
            "columns": [
              {
                "name": "ad_position"
              },
              {
                "name": "browser"
              },
              {
                "name": "creative_size"
              },
              {
                "name": "dim_event_demographics_key"
              },
              {
                "name": "internetconnection"
              },
              {
                "name": "os"
              }
            ]
          },
          {
            "name": "gender",
            "columns": [
              {
                "name": "gender"
              }
            ]
          },
          {
            "name": "krux_segment_krux_only",
            "columns": [
              {
                "name": "segment"
              },
              {
                "name": "segment_name"
              }
            ]
          },
          {
            "name": "many_to_many_krux",
            "columns": [
              {
                "name": "krux_key"
              },
              {
                "name": "split_part"
              }
            ]
          },
          {
            "name": "manytomany_new",
            "columns": [
              {
                "name": "demographic segments"
              },
              {
                "name": "segmentid"
              }
            ]
          },
          {
            "name": "Metrics",
            "columns": [
              {
                "name": "activeinviewtime"
              },
              {
                "name": "activeinviewtime_average"
              },
              {
                "name": "activepagedwell_content"
              },
              {
                "name": "activeview_eligibleimpression"
              },
              {
                "name": "ad_position"
              },
              {
                "name": "ad_unit_key"
              },
              {
                "name": "adcreative_key"
              },
              {
                "name": "admant"
              },
              {
                "name": "advertiser_key"
              },
              {
                "name": "automated_browser_rate"
              },
              {
                "name": "auuid"
              },
              {
                "name": "belowfoldad"
              },
              {
                "name": "belowfoldad_count"
              },
              {
                "name": "category"
              },
              {
                "name": "category_key"
              },
              {
                "name": "Clicks"
              },
              {
                "name": "clicks_users"
              },
              {
                "name": "costperunit"
              },
              {
                "name": "country_key"
              },
              {
                "name": "creative_key"
              },
              {
                "name": "creative_size"
              },
              {
                "name": "data_center_traffic_rate"
              },
              {
                "name": "date_key"
              },
              {
                "name": "dfp_click_erights_id"
              },
              {
                "name": "dfp_click_user_id"
              },
              {
                "name": "dfp_impression_erights_id"
              },
              {
                "name": "dfp_impression_user_id"
              },
              {
                "name": "event_key"
              },
              {
                "name": "gender"
              },
              {
                "name": "guid"
              },
              {
                "name": "imp_demos_key"
              },
              {
                "name": "Impressions"
              },
              {
                "name": "impressions_users"
              },
              {
                "name": "incongruous_browser_rate"
              },
              {
                "name": "industry"
              },
              {
                "name": "inview_false"
              },
              {
                "name": "inview_true_percent"
              },
              {
                "name": "isknownspider_rate"
              },
              {
                "name": "krux_key"
              },
              {
                "name": "measurable_impression"
              },
              {
                "name": "netcpm"
              },
              {
                "name": "nht_totalimpressions"
              },
              {
                "name": "nhtmeasurableimpressions"
              },
              {
                "name": "position"
              },
              {
                "name": "pt"
              },
              {
                "name": "res"
              },
              {
                "name": "responsibility"
              },
              {
                "name": "revenuecalc"
              },
              {
                "name": "scroll"
              },
              {
                "name": "scroll_count"
              },
              {
                "name": "segmentid"
              },
              {
                "name": "slv"
              },
              {
                "name": "tablekey"
              },
              {
                "name": "time_key"
              },
              {
                "name": "timeuntilinview"
              },
              {
                "name": "totalimpressionsunfiltered"
              },
              {
                "name": "totalinteractions"
              },
              {
                "name": "totalinview_time"
              },
              {
                "name": "totalinviewimpressions"
              },
              {
                "name": "totalinviewtime_average"
              },
              {
                "name": "totalmeasurableimpressions"
              },
              {
                "name": "user_demos_key"
              },
              {
                "name": "user_id"
              },
              {
                "name": "value"
              },
              {
                "name": "viewable_impression"
              }
            ],
            "measures": [
              {
                "name": "Active 5s+ Active In-view Avg dwell time (s)"
              },
              {
                "name": "Active 5s+ view%"
              },
              {
                "name": "Active View Viewable Impressions %"
              },
              {
                "name": "activeinviewtime_averages"
              },
              {
                "name": "activeinviewtime_percent%"
              },
              {
                "name": "activeinviewtime_total_secs"
              },
              {
                "name": "activepagedwell_content_secs"
              },
              {
                "name": "All unique users"
              },
              {
                "name": "Automated browser impressions"
              },
              {
                "name": "belowfoldad_percent%"
              },
              {
                "name": "Combined_Revenue"
              },
              {
                "name": "countofimpressions"
              },
              {
                "name": "CTR"
              },
              {
                "name": "CumulativeImpressions"
              },
              {
                "name": "Data centre impressions"
              },
              {
                "name": "datecalc"
              },
              {
                "name": "daterange"
              },
              {
                "name": "DFP impressions per Active 5s+ hour"
              },
              {
                "name": "Distinct Count Clicks DFP Users"
              },
              {
                "name": "Distinct Count Clicks Erights Users"
              },
              {
                "name": "e_CPM"
              },
              {
                "name": "e_CPM_old"
              },
              {
                "name": "e_CPM2"
              },
              {
                "name": "e_CPM3"
              },
              {
                "name": "eCPM"
              },
              {
                "name": "eCPM_CPM"
              },
              {
                "name": "In view Avg dwell time"
              },
              {
                "name": "Incongruous browser impressions"
              },
              {
                "name": "interaction rate"
              },
              {
                "name": "In-view %"
              },
              {
                "name": "In-view%"
              },
              {
                "name": "Is known spider impressions"
              },
              {
                "name": "IVT %"
              },
              {
                "name": "IVT measurable impressions"
              },
              {
                "name": "IVT%"
              },
              {
                "name": "IVT_impressions"
              },
              {
                "name": "IVT_measurable_impressions"
              },
              {
                "name": "Known unique users"
              },
              {
                "name": "Measurable Impressions1"
              },
              {
                "name": "MeasurableImpressions"
              },
              {
                "name": "net_value"
              },
              {
                "name": "Revenue"
              },
              {
                "name": "scroll_percentage"
              },
              {
                "name": "Sell Through"
              },
              {
                "name": "SponsorshipRollup2"
              },
              {
                "name": "SPRrevenue"
              },
              {
                "name": "Sum of Distinct Clicks"
              },
              {
                "name": "sumxsponsorshiptotal"
              },
              {
                "name": "time until view avg secs"
              },
              {
                "name": "Total  Impressions"
              },
              {
                "name": "Total Active In-view 5s+ exposure time (hour)"
              },
              {
                "name": "Total Clicks"
              },
              {
                "name": "Total clicks known users"
              },
              {
                "name": "Total clicks unknown users"
              },
              {
                "name": "Total impressions known users"
              },
              {
                "name": "Total impressions unknown users"
              },
              {
                "name": "total_interactions"
              },
              {
                "name": "Total_Revenue"
              },
              {
                "name": "Total_Revenue1"
              },
              {
                "name": "totalecpm"
              },
              {
                "name": "totalinview_time_secs"
              },
              {
                "name": "Unknown unique users"
              },
              {
                "name": "Viewable Impressions"
              },
              {
                "name": "In view exposure tim(mins)e"
              },
              {
                "name": "Total In-view exposure time(hrs)"
              },
              {
                "name": "Automated browser%"
              },
              {
                "name": "Data centre%"
              },
              {
                "name": "Incongruous browser%"
              },
              {
                "name": "In-view Avg dwell time(s)"
              },
              {
                "name": "Is known spider%"
              },
              {
                "name": "IVT total Impressions"
              },
              {
                "name": "MOAT to DFP Measurable rate"
              },
              {
                "name": "Total impressions unfiltered"
              },
              {
                "name": "Total in-view impressions"
              },
              {
                "name": "Total measurable impressions"
              }
            ]
          },
          {
            "name": "Page_Type",
            "columns": [
              {
                "name": "page_type"
              }
            ]
          },
          {
            "name": "Region",
            "columns": [
              {
                "name": "city"
              },
              {
                "name": "continent"
              },
              {
                "name": "country"
              },
              {
                "name": "dim_event_country_key"
              },
              {
                "name": "region"
              },
              {
                "name": "trade_region"
              }
            ],
            "hierarchies": [
              {
                "name": "Regions"
              },
              {
                "name": "Trade Areas"
              }
            ]
          },
          {
            "name": "Res",
            "columns": [
              {
                "name": "res"
              }
            ]
          },
          {
            "name": "Segment_name_DT",
            "columns": [
              {
                "name": "segment_name"
              }
            ]
          },
          {
            "name": "SLV",
            "columns": [
              {
                "name": "slv"
              }
            ]
          },
          {
            "name": "Time_of_Day",
            "columns": [
              {
                "name": "daycategory"
              },
              {
                "name": "dim_time_key"
              },
              {
                "name": "hour"
              }
            ]
          },
          {
            "name": "User_Demographics",
            "columns": [
              {
                "name": "companysize"
              },
              {
                "name": "companyturnover"
              },
              {
                "name": "demographic segments"
              },
              {
                "name": "dim_user_demographics_key"
              },
              {
                "name": "gender"
              },
              {
                "name": "industry"
              },
              {
                "name": "investorgroup"
              },
              {
                "name": "position"
              },
              {
                "name": "responsibility"
              }
            ]
          },
          {
            "name": "Users Clicks",
            "columns": [
              {
                "name": "id"
              },
              {
                "name": "userstatus"
              }
            ]
          },
          {
            "name": "Users_Impressions",
            "columns": [
              {
                "name": "id"
              },
              {
                "name": "userstatus"
              }
            ]
          }
        ]
      }
    ],
    "roles": [
      {
        "name": "Users",
        "modelPermission": "administrator",
        "members": [
          {
            "memberName": "ADFT\\DLO-AWS Redshift Users",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-1588"
          },
          {
            "memberName": "ADFT\\Magdalena.Ward",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-7681"
          },
          {
            "memberName": "ADFT\\Barry.Cassidy",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-8153"
          },
          {
            "memberName": "ADFT\\joshua.ford",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-8139"
          },
          {
            "memberName": "ADFT\\Alistair.Smith",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-7697"
          },
          {
            "memberName": "ADFT\\Malika.Mauldin",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-7369"
          },
          {
            "memberName": "ADFT\\Stephanie.Wong",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-8418"
          },
          {
            "memberName": "ADFT\\Tomoaki.Hirano",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-5515"
          },
          {
            "memberName": "S-1-5-21-3969848028-2180855670-1813860057-9176",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-9176"
          },
          {
            "memberName": "S-1-5-21-3969848028-2180855670-1813860057-9450",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-9450"
          },
          {
            "memberName": "S-1-5-21-3969848028-2180855670-1813860057-2595",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-2595"
          },
          {
            "memberName": "S-1-5-21-3969848028-2180855670-1813860057-7133",
            "memberId": "S-1-5-21-3969848028-2180855670-1813860057-7133"
          }
        ]
      }
    ]
  },
  "id": "SemanticModel"
}